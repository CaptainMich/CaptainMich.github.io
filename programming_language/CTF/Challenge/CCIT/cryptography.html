<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title> CyberChallenge | Cryptography </title>
    <link rel="shortcut icon" href="/img/favicon.ico" width="70">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <link rel="stylesheet" href="/fonts/fonts.css" >
      <link rel="stylesheet" href="/res/bootstrap.min.css">
      <link rel="stylesheet" href="/res/w3.css">
      <link rel="stylesheet" href="/css/style.css">
      <link rel="stylesheet" href="/css/personal_icon.css">
      <link rel="stylesheet" href="/res/prism_themes/prism-base16-ateliersulphurpool.light.css">
      <link rel="stylesheet" href="../ctf.css">
      <link rel="stylesheet" href="../../css/sidebar.css">

      <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
  </head>
  <body>

    <!-- Navbar -->
    <div id="include_navbar"></div>


    <!-- Return to Top -->
    <a href="javascript:" id="return-to-top"><i class="fas fa-chevron-up"></i></a>

    <!-- Sidebar Nav -->
    <div id="include_sidebar"></div>

    <!-- Main -->
    <main>
    <div class="swipe-area"></div>
    <br><br><br>
    <div class="container">
      <article role="article">
    		<h3> Cryptography </h3>
        <br>

        <dl class="toc">
          <h4> Table of Contents </h4>
          <ol>
            <h5> Week 1 </h5>
            <li> <a href="#spin-arovnd"> Spin Arovnd - Points: 500 </a></li>
            <li> <a href="#planet-matrix"> Planet Matrix - Points: 500 </a></li>
            <li> <a href="#dropped"> Dropped- Points: 500 </a></li>
            <li> <a href="#secure-padding"> Secure padding - Points: 500 </a></li>
            <li> <a href="#once-too-many"> Once too many - Points: 500 </a></li>
            <li> <a href="#benchmark"> Benchmark - Points: 500 </a></li>
            <li> <a href="#see-you-in-the-center"> See you in the center - Points: 500 </a></li>
            <li> <a href="#redacted"> Redacted - Points: 500 </a></li>
          </ol>
          <hr style="margin-bottom: 0em; width: 20%; margin-left: 42%;">
          <ol>
            <h5> Week 2 </h5>
            <li> <a href="#rsa-walkthrough"> RSA Walkthrough - Points: 500 </a></li>
            <li> <a href="#decrypt-me-1"> Decrypt me (level 1) - Points: 500 </a></li>
            <li> <a href="#decrypt-me-2"> Decrypt me (level 2) - Points: 500 </a></li>
            <li> <a href="#(rs)2a"> (RS)²A - Points: 500 </a></li>
            <li> <a href="#oracle-1"> Oracle (level 1) - Points: 500 </a></li>
            <li> <a href="#oracle-2"> Oracle (level 2) - Points: 500 </a></li>
          </ol>
          <hr style="margin-bottom: 0em; width: 20%; margin-left: 42%;">
          <ol>
            <h5> Week 3 </h5>
            <li> <a href="#key-exchange"> Key Exchange - Points: 500 </a></li>
            <li> <a href="#kerberos-simulator"> Kerberos Simulator - Points: 500 </a></li>
          </ol>
        </dl>
        <hr style="margin-bottom: 3em; width: 30%; margin-left: 35%;">

<!-- Start Post  -->
        <dl class="anchor" id="spin-arovnd">
          <dt> Spin Arovnd - Points: 500 </dt>
          <dd> Just a little cryptography warmup: </dd>
        </dl>

        <dl>
          <blockquote>
            <p><strong> <code> TTZK{Xrzlj_Alczlj_Trvjri} </code>  </strong> <br>
            </p>
          </blockquote>
        </dl>

        <dl>
          <dd>
            Supposing that is a Caesar cipher, let's try to bruteforcing it
          </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-python">
import string

# Encrypted message
message = ' TTZK{Xrzlj_Alczlj_Trvjri}'
#LETTERS = string.ascii_lowercase
LETTERS_UP = string.ascii_uppercase
LETTERS_LOW = string.ascii_lowercase

for key in range(len(LETTERS_UP)):
    translated = ''
    for symbol in message:
        if (symbol.isupper() and symbol in LETTERS_UP):
            num = LETTERS_UP.find(symbol)
            num = num - key
            if num < 0:
                num = num + len(LETTERS_UP)
            translated += LETTERS_UP[num]
        elif(symbol.islower() and symbol in LETTERS_LOW):
            num = LETTERS_LOW.find(symbol)
            num = num - key
            if num < 0:
                num = num + len(LETTERS_LOW)
            translated += LETTERS_LOW[num]
        else:
            translated = translated + symbol

    print('Hacking key #{}: {}'.format(key, translated))
          </code></pre>
        </div>

        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong> CCIT{Gaius_Julius_Caesar} </strong></p>
          </blockquote>
        </dl>
        </div>
        <hr>
<!-- Finish post  -->
<!-- Start Post  -->
        <dl class="anchor" id="planet-matrix">
          <dt> Planet Matrix - Points: 500 </dt>
          <dd> Google and the images below will help you to translate the following ciphertext: </dd>
        </dl>

        <dl>
          <blockquote>
            <p><strong>  <code> CGKRKRLANXBERXBHLGAUVSZMQODKGB </code>  </strong> <br>
               The flag is NOT standard: put the plaintext into CCIT{ }
            </p>
          </blockquote>
        </dl>

        <div class="fig-container">
          <figure class="zoom" onmousemove="zoom(event)"
          style="background-image: url('\img/3-01-planet-matrix.jpg')" >
            <img src="img/3-01-planet-matrix.jpg" alt="" />
          </figure>
        </div>

      <dl>
        <dd>
          Let's google for the image: it's Charles Wheatstone. He is scientist and inventor of many scientific breakthroughs of the Victorian era, one of them is the Playfair cipher.
        </dd>
      </dl>

        <div class="row-full code">
          <pre><code class="prism language-bash">
# An online tool has been used
# http://rumkin.com/tools/cipher/playfair.php
          </code></pre>
        </div>

        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong> CCIT{THISISANAYFAXACIPHERYOEURQKSIT} </strong></p>
          </blockquote>
        </dl>
        </div>
        <hr>
<!-- Finish post  -->
<!-- Start Post  -->
        <dl class="anchor" id="dropped">
          <dt> Dropped - Points: 500 </dt>
          <dd> Ops! I dropped the key! </dd>
        </dl>

        <dl>
          <blockquote>
            <p><strong>  <code> TCICmI_{_d343_m4}s!s </code>  </strong> <br>
            </p>
          </blockquote>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-bash">
# An online tool has been used
# http://rumkin.com/tools/cipher/playfair.php
          </code></pre>
        </div>

        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong> CCIT{I_m4d3_4_m3ss!} </strong></p>
          </blockquote>
        </dl>
        </div>
        <hr>
<!-- Finish post  -->
<!-- Start Post  -->
        <dl class="anchor" id="secure-padding">
          <dt> Secure padding - Points: 500 </dt>
          <dd> Passwords should be at least 32 characters long! Give us your password, we'll think about it!  This is a remote challenge, you can connect to the service with:
          <code> nc 149.202.200.158 7000 </code> </dd>
        </dl>

        <dl>
          <dd>
            Following the script used on the remote server:
          </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-python">
#!/usr/bin/env python3

import signal
from binascii import hexlify
from string import printable
from random import randint
from secret import FLAG
from Crypto.Cipher import AES

TIMEOUT = 300
BLOCK = 16

def pad(s):
  return s + (BLOCK - len(s) % BLOCK) * chr(BLOCK - len(s) % BLOCK)

def randkey():
  return "".join([printable[randint(0, len(printable)-8)] for _ in range(BLOCK)]).encode()

def handle():
  print("=====================================")
  print("=     Secure Password Encrypter     =")
  print("=     Now with secure padding!      =")
  print("=====================================")

  cipher = AES.new(randkey(), AES.MODE_ECB)

  while True:
    print("")
    try:
      password = input("Give me the password to encrypt:")
      password = pad(password + FLAG).encode()
      password = hexlify(cipher.encrypt(password)).decode()
      print("Here is you secure encrypted password:", password)
    except EOFError:
      break

if __name__ == "__main__":
    signal.alarm(TIMEOUT)
    handle()
          </code></pre>
        </div>

        <dl>
          <dd>
            If we try to input something, the script returns us something encrypted in hexadecimal form. Looking into the code we can immediately understand that an AES cipher is initialized in ECB (Electronic Code Book) mode; then, inside the infinite loop, the program asks user for the password and catenates it with the flag plus a padding to get a multiple size of 16. Finally, the encryption is performed by using the cipher previously initialized with the password; the key used is generate randomly at each start. <br> <br>
            <b> ECB </b> -> the message is divided into blocks and each block is encrypted/decrypted separately using always the same key; since there is no diffusion, ECB encrypt same plaintext in same ciphertext <br> <br>
            Let's try to use these informations to break the cipher. <br>
            First of all we can start by sending a long password to the server and see what happens:
          </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-text">
Password sent:
AAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAA

Encrypted password:
5033b05ba53d7c8ab88f65ccb2e07bba
5033b05ba53d7c8ab88f65ccb2e07bba
718e07e3345d2b62b1b087dee193a3cc
f95c8a7e26d6dd73635578c77de59710
          </code></pre>
        </div>

        <dl>
          <dd>
            As we can see the first two blocks are the same, because the password we sent exceed the size of a single block, for this reason the block is broken in two different block which contain the same encrypted text. <br> <br>
            Let's analyze now how the padding function work:
          </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-python">
def pad(s):
  return s + (BLOCK - len(s) % BLOCK) * chr(BLOCK - len(s) % BLOCK)

>>> BLOCK = 16
>>> pad("A")
'A\x0f\x0f\x0f\x0f\x0f\x0f\x0f\x0f\x0f\x0f\x0f\x0f\x0f\x0f\x0f'
>>> pad("AAAA")
'AAAA\x0c\x0c\x0c\x0c\x0c\x0c\x0c\x0c\x0c\x0c\x0c\x0c'
>>> pad("A"*16)
'AAAAAAAAAAAAAAAA\x10\x10\x10\x10\x10\x10\x10\x10\x10\x10\x10\x10\x10\x10\x10\x10'
>>> pad("A"*15)
'AAAAAAAAAAAAAAA\x01'
          </code></pre>
        </div>

        <dl>
          <dd>
            Now that we have understood how the function works, suppose our flag is <i> <b> CCIT{testing}</b> </i>
          </dd>
        </dl>


        <div class="row-full code">
          <pre><code class="prism language-python">
>>> msg = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
>>> FLAG = "CCIT{testing}"
>>> pad(msg+FLAG)
'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACCIT{testing}\x03\x03\x03'\
          </code></pre>
        </div>

        <dl>
          <dd>
            Since the ECB is breakable, we can try to understand character by character of the flag simple breaking the semplicity of the cipher which encode same <i> plaintext </i> in <i> same ciphertext </i>
          </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-python">
>>> "A" * 15 + "C" + "A" * 15 + FLAG
'AAAAAAAAAAAAAAACAAAAAAAAAAAAAAACCIT{testing}'

AAAAAAAAAAAAAAAC
AAAAAAAAAAAAAAAC
CIT{testing}
          </code></pre>
        </div>

        <dl>
          <dd>
            Since the last character of the second block is the first character of the flag we will have a match between the first and the second block only when the two block are the same. So, by deacreasing the counter at each step and then bruteforcing the right character by trying them all we can finally obtain our flag. The script used is:
          </dd>
        </dl>


        <div class="row-full code">
          <pre><code class="prism language-python">
#!/usr/bin/env python3
from pwn import *
from string import printable

BLOCK = 32

def check(msg):
    p.recvuntil("encrypt:")
    p.sendline(msg)
    p.recvuntil("password: ")
    encrypted = p.recvline().decode('utf-8').strip()
    return encrypted

def block(str):
  return [str[i:i+BLOCK] for i in range(0, len(str), BLOCK)]

#counter = 11
counter = 31
test = ''
LETTERS =  string.printable[:-6]
#flag = "CCIT{r3m3mb3r_th3_3c"
flag = ''

p = remote('149.202.200.158', 7000)

for i in range(0,40):
    for c in LETTERS:
        print(c)
        test = flag
        test += c
        sendline = "A" * counter + test + "A" * counter
        print(sendline)
        result = block(check(sendline))
        print(result)
        if result[1] == result[3]:
            flag += c
            test += c
            counter -= 1
            #print(result)
        print("FLAG: {}".format(flag))

    # for r in result:
    #     print(r)

p.interactive()
          </code></pre>
        </div>


        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong> CCIT{r3m3mb3r_th3_3cb_p3ngu1n?}  </strong></p>
          </blockquote>
        </dl>
        </div>
        <hr>
<!-- Finish post  -->
<!-- Start Post  -->
        <dl class="anchor" id="once-too-many">
          <dt> Once too many - Points: 500 </dt>
          <dd> I have a keychain but all the keys are the same! </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-bash">
03f2794833cf53f9dcc2206609fd9c3b27269f7b8f38c79301db2f3ac2c764ab3ac0d7ad075ba
191598664241d3d6e7ca113276612cbe476bf7ec544564dad
1eee3b1b7cd753abd18b3e6a44fd913a3d6f853ddb29cdc640de2d3cd39369b47f8dd9a0420fa
8d4148a73321d7a643af40e3a7a03cfe53ab570dc4e5f5aa3fa01fe7df7cd7986e15b31bafccb
c4563160a1
3def6f1c7cc25eb8c6cc28234cec9e37272c843a8931c1c705db6c3dc19369b33ac0d7b94e48a
09a1883202c196e727be605737d198ae876ab76cc0c4757e2fa4ea773eccd7f86f91e30bbf8c1
c65278
35ef684828c957ad88c7226c42fedd2d662188349670d6dc40c8223dd3db78a97f90ddb95440a
7da59ac43082866752ab13f3e2019d3d622ed7a865f1242
1efc3c1c34c416aac9c6282342e8847f6e3ccc2e8835c6930dc63e3787c775ba31c0d7a5444ae
5d41b8e646108756874e61373631ec6e576b476c55c5651a3ef00ba3ce08269c7e0572eb2aec3
db06207dadba75a21277
16e93c1b33ce58f9c9d86d7a46f8dd376639897b9e3ec1dc04cc2872c69370be2c93d9ac420fb
e9d0d8720205c7a686ce40e736416cea576a87fc743441feafa4ebf6bf8943c8efa5327bae7c5
c043386badb37eaa5e3fe7b98c0de3564243
03f2794833cf53f9dcc2206609fd9c3b27269f7b883f82c009c43c3ec29369b33e9498a4494ae
998109b742d193d6373f5403c7257c9e824b97bd05f4051e6fd1dfe7ff8833c85e55b23b5aecd
c007
          </code></pre>
        </div>

        <dl>
          <dd>
            Since the tag of the flag claims "perfect secrecy" we can suppose it is One Time Pad Algorithm. Let's try to break it. One usefull tool is mtp(man time pad)
          </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-text">
$ mtp message.enc

┌ Decryptions ────────────────────────────────────────────────────────────────────────────────┐
│  1   ___ o_e time _ad_is the a_chet__e o_ t__ _dea_____t_ea_ r_chd__                        │
│  2   ___s _ery sim_le_ if you _ant __ ma_e __m_ssa_____i_te_lx_zbm___o a_ ea_e__r______     │
│  3   ___t _hange e_ch_characte_ of __e o_ig__a_ me_____ _n _ f_j u___ yo_ ca_ __v____       │
│  4   ___ t_at look_ r_ndom to _noth__ pe_so__ _CIT_____m_ny_t _ s _                         │
│  5   ___th_ same k_y _s used m_re t__n o_ce__b_d t_____ _il_ y_cpd___nd _ou _i__ _________lh│
│  6   ___so_n as yo_ h_ve encod_d a __ssa_e __t_ a _____ _ad_ e_aov___ aw_y i_m__i_________  │
│  7   ___ o_e time _ad_is so si_ple __at _ne__i_tle_____o_ c_rt_vsr___s c_n b_e__ ___        │
└─────────────────────────────────────────────────────────────────────────────────────────────┘
┌ Key ────────────────────────────────────────────────────────────────────────────────────────┐
│______685c__36d9a8ab4d0329__fd5f__4fec5bfb50a2b360__4c52a7b3____5fe0b8__272f____79__00417c___|
│______53__77aa__56cd__a62c32______6ede1c__ed1ce7__3e____8e__________________7e1f             |
└─────────────────────────────────────────────────────────────────────────────────────────────┘
          </code></pre>
        </div>

        <div class="row-full code">
          <pre><code class="prism language-python">
┌ Decryptions ───────────────────────────────────────────────────────────────────────────────┐
│  1   the one time pad is the archetype of the idea of stream cipher.                       │
│  2   it's very simple: if you want to make a message unintelligible to an eavesdropper,    │
│  3   Just change each character of the original message in a way that you can revert,      │
│  4   But that looks random to another person. CCIT{t00_m4ny_t1m3s!}                        │
│  5   if the same key is used more than once, bad things will happen and you will go to hell│
│  6   as soon as you have encoded a message with a given pad, throw it away immediately and │
│  7   the one time pad is so simple that one little bit of carelessness can break it!       │
└────────────────────────────────────────────────────────────────────────────────────────────┘
┌ Key ───────────────────────────────────────────────────────────────────────────────────────┐
│779a1c685ca136d9a8ab4d03298dfd5f074fec5bfb50a2b360a94c52a7b31ddb5fe0b8cb272fc9f479ef00417c1d|
|011a8160531477aa8956dc17b52c333f838e6ede1c99ed1ce7973e42de8ea4b42654128dd210ce7e57          |
└────────────────────────────────────────────────────────────────────────────────────────────┘
          </code></pre>
        </div>


        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong> CCIT{t00_m4ny_t1m3s!} </strong></p>
          </blockquote>
        </dl>
        </div>
        <hr>
<!-- Finish post  -->
<!-- Start Post  -->
        <dl class="anchor" id="benchmark">
          <dt> Benchmark - Points: 500 </dt>
          <dd> Performance is the most important thing when it comes to cryptography. This is a remote challenge, you can connect to the service with: <code> nc 149.202.200.158 7001 </code>
        </dl>

        <dl>
          <dd>
            Connecting by using netcat lead us to the following screen page
          </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-text">
=========================================================================
=                   Welcome to the super secure vault!                  =
=             (Debug mode activated for benchmark purpose)              =
=========================================================================

Give me the password to check:
          </code></pre>
        </div>

        <dl>
          <dd>
            Typing just one character in, return as: <br>
            <i> <b style="color: #585858;"> &emsp; &emsp; &emsp; &emsp; Wrong password, checked in 208 clock cycles </b>  </i> <br> <br>
            This suggest us that we could try an attack based on the timer, if we are able to identify, for each character, the character that takes more clock cycles we can get the password
          </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-python">
#!/usr/bin/env python3

from pwn import *
from string import *

# remotely conect to the server
p = remote('149.202.200.158', 7001)

# send a message to the input line
# and return the clock of each of them
def check(msg):
	p.recvuntil("check:")
	p.sendline(msg)
	p.recvuntil("checked in")
	clock = int(p.recvline().split(" ")[0])
	return clock

max_time = 0
max_c = None
flag = ""
test = ""
characters = printable[:-6]

for i in range(0, 1000):
    for c in characters:
        test = flag
        test += c
        c_time = check(test)
        #print("{} : {}".format(c,c_time))

        if c_time > max_time:
            max_time = c_time
            max_c = c

    # print(max_c)
    characters.replace(max_c, "")
    flag += max_c
    print(flag)

#print("Max_Time:\t{}\nC_Time:\t{}".format(max_c, max_time))
# print("Clock: {}", check("hello"))
p.interactive()


          </code></pre>
        </div>

        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong> CCIT{s1d3_ch4nn3ls_r_c00l} </strong></p>
          </blockquote>
        </dl>
        </div>
        <hr>
<!-- Finish post  -->
<!-- Start Post  -->
        <dl class="anchor" id="see-you-in-the-center">
          <dt> See you in the center - Points: 500 </dt>
          <dd> I forgot the key at home while I was going in the city center, can you recover it?
        </dl>


        <div class="row-full code">
          <pre><code class="prism language-python">
#!/usr/bin/python3

import string
import base64

from secret import KEY

def encrypt(clear, key):
  enc = []
  for i in range(len(clear)):
    key_c = key[i % len(key)]
    enc_c = chr((ord(clear[i]) + ord(key_c)) % 128)
    enc.append(enc_c)
  return str(base64.urlsafe_b64encode("".join(enc).encode('ascii')), 'ascii')

'''
# For debug purpose
def decrypt(enc, key):
    dec = []
    enc = str(base64.urlsafe_b64decode(enc.encode('ascii')), 'ascii')
    for i in range(len(enc)):
        key_c = key[i % len(key)]
        dec_c = chr((128 + ord(enc[i]) - ord(key_c)) % 128)
        dec.append(dec_c)
    return "".join(dec)

assert(len(KEY) == 8)
assert(all(c in string.ascii_lowercase for c in KEY))
'''

print("flag: CCIT{%s}" % KEY)

k1 = KEY[0:4]
k2 = KEY[4:8]

m = "See you later in the city center"
d = encrypt(m, k1)
c = encrypt(d, k2)

print("Message:", m)
print("Ciphertext:", c)


'''
m = "See you later in the city center"
c = "QSldSTQ7HkpIJj9cQBY3VUhbQ01HXD9VRBVYSkE6UWRQS0NHRVE3VUQrTDE="
'''
          </code></pre>
        </div>

        <dl>
          <dd>
            This time everything can be done on the local machine. The codition about our flag can be obtained by looking at the <code> assert </code> statement in the code: first condition says that the key must be 8 characters long, the second one that every characters of the key are ASCII lowercase.
            The key is breaken in two pieces then a two phases encryption is performed: the message is encrypted first with the low part of the key then the result is encrypted again with the high part of the key. <br>
            An easy way of decreasing the number of attempts to get the key is using the MITM (meet-in-the-middle). Since we have the following property <br>
            <i> <b style="color: #585858;"> &emsp; &emsp; &emsp; &emsp; decrypt(encrypt(msg, key),  key) = msg </b> </i> <br> <br>
            We can write our code as:
          </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-python">
#decrypt(c, k2) = decrypt(encrypt(encrypt(m, k1), k2), k2)
decrypt(c, k2) = encrypt(m, k1)

# add this line to the code to demonstrate that teh relation is correct
print(decrypt(c, k2))
print(encrypt(m, k1))
          </code></pre>
        </div>

        <dl>
          <dd>
            We can now bruteforce only 4 characters at each time:
          </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-python">
# add these lines to the code
for c1 in string.ascii_lowercase:
  for c2 in string.ascii_lowercase:
    for c3 in string.ascii_lowercase:
      for c4 in string.ascii_lowercase:
        k1 = c1 + c2 + c3 + c4
        (print(k1, encrypt(m, k1)))
          </code></pre>
        </div>

        <dl>
          <dd>
            Our aim is to find the pair of keys (k1, k2) that satisfy the equation <br>
            <i> <b style="color: #585858;"> &emsp; &emsp; &emsp; &emsp; decrypt(c, k2) == encrypt(m, k1) </b> </i> <br> <br>
            Let's now try to understand, given a message, which key generated it: given the cypher we want to know the key.
          </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-python">
# comment line: from secret import KEY
KEY = "abcd efgh"

# add this lines inside the last for cycle
db[encrypt(m, k1)] = k1

# print the first key
print(db[d])

# output
>>> abcd
          </code></pre>
        </div>

        <dl>
          <dd>
            Our aim is to find the pair of keys (k1, k2) that satisfy the equation <br>
            <i> <b style="color: #585858;"> &emsp; &emsp; &emsp; &emsp; decrypt(c, k2) == encrypt(m, k1) </b> </i> <br>
            Let's now try to understand, given a message, which key generated it: given the cypher we want to know the key.The process is the same as before but this time when we found a value of decrypt(c, k2) which is already in the database of keys (<code>db</code>) then we have found the key.
          </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-python">
# add these lines to the code
for c1 in string.ascii_lowercase:
  for c2 in string.ascii_lowercase:
    for c3 in string.ascii_lowercase:
      for c4 in string.ascii_lowercase:
        k2 = c1 + c2 + c3 + c4
        if decrypt(c, k2) in db:
          k1 = db[decrypt(c, k2)]
          K = k1 + k2
          </code></pre>
        </div>

        <dl>
          <dd>
            Let's now use given <code> m </code> and <code> c </code> as message and cypher. <br>
            (To check if the key is correct just use the founded key as KEY and add <code style="font-size:0.75em"> assert(c == 'QSldSTQ7HkpIJj9cQBY3VUhbQ01HXD9VRBVYSkE6UWRQS0NHRVE3VUQrTDE=')</code> )
          </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-python">
#!/usr/bin/python3

import string
import base64

#from secret import KEY

#KEY = 'abcdefgh'

def encrypt(clear, key):
    enc = []
    for i in range(len(clear)):
        key_c = key[i % len(key)]
        enc_c = chr((ord(clear[i]) + ord(key_c)) % 128)
        enc.append(enc_c)
    return str(base64.urlsafe_b64encode("".join(enc).encode('ascii')), 'ascii')

# For debug purpose
def decrypt(enc, key):
    dec = []
    enc = str(base64.urlsafe_b64decode(enc.encode('ascii')), 'ascii')
    for i in range(len(enc)):
        key_c = key[i % len(key)]
        dec_c = chr((128 + ord(enc[i]) - ord(key_c)) % 128)
        dec.append(dec_c)
    return "".join(dec)

m = "See you later in the city center"
c = "QSldSTQ7HkpIJj9cQBY3VUhbQ01HXD9VRBVYSkE6UWRQS0NHRVE3VUQrTDE="

db = {}

# encrypt(m, k1)
for c1 in string.ascii_lowercase:
    for c2 in string.ascii_lowercase:
        for c3 in string.ascii_lowercase:
            for c4 in string.ascii_lowercase:
                k1 = c1 + c2 + c3 + c4
                #(print(k1, encrypt(m, k1)))
                db[encrypt(m, k1)] = k1

# decrypt(c, k2)
for c1 in string.ascii_lowercase:
    for c2 in string.ascii_lowercase:
        for c3 in string.ascii_lowercase:
            for c4 in string.ascii_lowercase:
                k2 = c1 + c2 + c3 + c4
                #(print(k1, encrypt(m, k1)))
                if decrypt(c, k2) in db:
                    print("FOUND")
                    k1 = db[decrypt(c,k2)]
                    K = k1 + k2
                    print("KEY: ", K)

          </code></pre>
        </div>

        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong> CCIT{ufoundit} </strong></p>
          </blockquote>
        </dl>
        </div>
        <hr>
<!-- Finish post  -->
<!-- Start Post  -->
        <dl class="anchor" id="redacted">
          <dt> Redacted - Points: 500 </dt>
          <dd> Security through o█scurity! </dd>
        </dl>

        <dl>
          <blockquote>
            <p><strong> Flag format: CCIT{IV} (see challenge.py) </strong>
            </p>
          </blockquote>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-python">
#!/usr/bin/env python2.7

from Crypto.Cipher import AES
import binascii, sys

KEY = "yn9RB3Lr43xJK2██".encode()
IV  = "████████████████".encode()
msg = "AES with CBC is very unbreakable".encode()

aes = AES.new(KEY, AES.MODE_CBC, IV)
print binascii.hexlify(aes.encrypt(msg)).decode()

# output:
# c5██████████████████████████d49e78c670cb67a9e5773d696dc96b78c4e0

          </code></pre>
        </div>

        <dl>
          <dd>
            As it's noticeable, the program makes an AES (Advanced Encryption Standard) encryption in Cipher Block Chaining (CBC), which is a mode of operation for AES: the plaintext and ciphertext are divide into blocks of a defined length; before encrypting the plaintext block number <i>n</i> with AES, it becomes xored with the ciphertext block <i>n-1</i>. Because the first plaintext block has no cipher text befor itself to xor with, there is an initialisation vector (IV) for this.  <br> <br>

            Since we know the second ciphertext block, the plaintext and parts of the first block of ciphertext, we can brute force the key's last two characters by decrypting the second block of ciphertext with all possible keys, xoring with the first block of ciphertext (the unknown parts padded by zeros) and see, for which key the first letter and last two letters of the result match to the original plaintext.
          </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-python">
from Crypto.Cipher import AES
from operator import xor
import binascii, sys
import string

LETTERS =  string.printable[:-6]
KEY_first = "yn9RB3Lr43xJK2"
cipher1 = "c500000000000000000000000000d49e"
cipher2 = "78c670cb67a9e5773d696dc96b78c4e0"
plain1 = "AES with CBC is "
plain2 = "very unbreakable"

def decrypt(cipher, passphrase):
    aes = AES.new(passphrase, AES.MODE_CBC, binascii.unhexlify(cipher1))
    return aes.decrypt(cipher)

for i in LETTERS:
    for j in LETTERS:
        key = KEY_first + i + j
        dec_plain2 = decrypt(binascii.unhexlify(cipher2),  key)
        if str(dec_plain2).startswith("v") and str(dec_plain2).endswith('le'):
            print("Decrypted plain2: " + dec_plain2 + " with key: " + key)
          </code></pre>
        </div>


        <dl>
          <dd>
            The output is: <br>
            <i> <b style="color: #585858;"> &emsp; &emsp; &emsp; &emsp; decrypted plain2: v�+� ��p�ӆ1Hle <br> &emsp; &emsp; &emsp; &emsp; key: yn9RB3Lr43xJK2tp </b> </i> <br> <br>
            The not printable characters emerge by xoring with the unknown and therefor zero-padded part of the first ciphertext block. <br> <br>

            Now that we have the AES key we can start looking for the first ciphertext block: since xor is revertable a⊕b=c⇔c⊕b=a and we now know the key, we can simply change the role of the first cipher text block and second plaintext block and do AES decryption on the second ciphertext block with the second plaintext block as IV (instead of the first cipher text block), which leads to the first ciphertext block as "decrypted paintext".
          </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-python">
from Crypto.Cipher import AES
import binascii, sys

KEY = "yn9RB3Lr43xJK2tp"
plain2 = "very unbreakable"

cipher2= "78c670cb67a9e5773d696dc96b78c4e0"

def decrypt(cipher,passphrase):
    aes = AES.new(passphrase,AES.MODE_CBC,plain2)
    return aes.decrypt(cipher)

# Output result
print("Decrypted data:" + binascii.hexlify(decrypt(binascii.unhexlify(cipher2), KEY)))
          </code></pre>
        </div>

        <dl>
          <dd>
            The output is: <br>
            <i> <b style="color: #585858;"> &emsp; &emsp; &emsp; &emsp; Decrypted data: c5dc598a00e6e31272bcb2ed502ad49e </b> </i> <br> <br>

            By changing roles again: this time we change the role of first plaintext block and IV when doing decryption on the first ciphertext block, which leads to the IV as decrypted plaintext.
          </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-python">
#!/usr/bin/env python2.7

from Crypto.Cipher import AES
import binascii, sys

KEY="yn9RB3Lr43xJK2tp"
IV="AES with CBC is "

cipher1="c5dc598a00e6e31272bcb2ed502ad49e"

def decrypt(cipher,passphrase):
    aes = AES.new(passphrase,AES.MODE_CBC,IV)
    return aes.decrypt(cipher)

print "decrypted data: " + decrypt(binascii.unhexlify(cipher1), KEY)
          </code></pre>
        </div>

        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong> CCIT{P4rt14l_1nf0_b4d} </strong></p>
          </blockquote>
        </dl>
        </div>
        <hr>
<!-- Finish post  -->
<!-- Start Post  -->
        <dl class="anchor" id="rsa-walkthrough">
          <dt> RSA Walkthrough - Points: 500 </dt>
          <dd> A step-by-step walkthrough for RSA cryptosystems. <br>
            This is a remote challenge, you can connect to the service with: <br> <code>  nc rsa.challs.cyberchallenge.it 7010 </code>
          </dd>
        </dl>

        <dl>
          <dd>
            This will be a step-by-step RSA quiz. Let's start by connect remotely to the server using pwntools
          </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-python">
from pwn import *

def main(args):
    dev = None

    dev = remote("rsa.challs.cyberchallenge.it", 7010)
    print(dev.recvall())
    sys.exit(0)

if __name__ == "__main__":
	main(sys.argv)
          </code></pre>
        </div>

        <dl>
          <dd>
            The output is the follow:
          </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-shell">
[DEBUG] Received 0x36 bytes:
    b'Welcome to the RSA interactive tutorial!\n'
    b'Follow me...\n'
[DEBUG] Received 0x2c bytes:
    b'Level 1\n'
    b'p = 2333792159\n'
    b'q = 3853146593\n'
    b'n = ?\n'
          </code></pre>
        </div>

        <dl>
          <dd>
            First of all we need to grab all the value, then since it ask for <i>n</i> we can calculate it: <b>n = p * q</b>
          </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-python">
# Level 1
dev.recvuntil('p = ')
p = int(dev.recvuntil('\n').decode("utf-8").replace('\n', ''))

dev.recvuntil('q = ')
q = int(dev.recvuntil('\n').decode("utf-8").replace('\n', ''))

n = p * q
dev.sendline(str(n))
          </code></pre>
        </div>

        <dl>
          <dd>
            Launch again the script. The output is the following:
          </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-shell">
[DEBUG] Received 0x11 bytes:
    b'Correct!\n'
    b'Level 2\n'
[DEBUG] Received 0x26 bytes:
    b'message = This is the plaintext\n'
    b'm = ?\n'
          </code></pre>
        </div>

        <dl>
          <dd>
            To solve this step we just need to convert the message in a readeable form for RSA which must be a number.
          </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-python">
# Level 2
dev.recvuntil('message = ')
plain = dev.recvuntil('\n').decode("utf-8").replace('\n', '')
m = int(hexlify(plain.encode()),16)
dev.sendline(str(m))
          </code></pre>
        </div>

        <dl>
          <dd>
            Launch again the script. The output is the following:
          </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-shell">
[DEBUG] Received 0x9 bytes:
    b'Correct!\n'
[DEBUG] Received 0x4e bytes:
    b'Level 3\n'
    b'p = 2328950303\n'
    b'q = 2720628007\n'
    b'm = 1857889334864637239\n'
    b'e = 65537\n'
    b'c = ?\n'
          </code></pre>
        </div>

        <dl>
          <dd>
            This step asks us for a ciphertext. In order to get it we need to retrieve <i>p</i> and <i>q</i>, then calculate <i>n</i> and retrieve <i>m</i> and <i>e</i>.
            Finally we can get the ciphertext by calculate <b>m</b> at the power of <b>e</b> modulo <b>n</b>.
          </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-python">
# Level 3
dev.recvuntil('p = ')
p = int(dev.recvuntil('\n').decode("utf-8").replace('\n', ''))
dev.recvuntil('q = ')
q = int(dev.recvuntil('\n').decode("utf-8").replace('\n', ''))
n = p * q
dev.recvuntil('m = ')
m = int(dev.recvuntil('\n').decode("utf-8").replace('\n', ''))
dev.recvuntil('e = ')
e = int(dev.recvuntil('\n').decode("utf-8").replace('\n', ''))

c = pow(m,e,n)
print(c)
dev.sendline(str(c))
          </code></pre>
        </div>

        <dl>
          <dd>
            Launch again the script. The output is the following:
          </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-shell">
[DEBUG] Received 0x9 bytes:
    b'Correct!\n'
[DEBUG] Received 0x3b bytes:
    b'Level 4\n'
    b'p = 4185340529\n'
    b'q = 2737877537\n'
    b'e = 65537\n'
    b'tot(n) = ?\n'
          </code></pre>
        </div>

        <dl>
          <dd>
            This time we are asked to calculate the <i>totient</i>: <b>tot(n): (p-1) * (q-1)</b>
          </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-python">
# Level 4
dev.recvuntil('p = ')
p = int(dev.recvuntil('\n').decode("utf-8").replace('\n', ''))
dev.recvuntil('q = ')
q = int(dev.recvuntil('\n').decode("utf-8").replace('\n', ''))
dev.recvuntil('e = ')
e = int(dev.recvuntil('\n').decode("utf-8").replace('\n', ''))

tot = (p-1) * (q-1)
dev.sendline(str(tot))
          </code></pre>
        </div>

        <dl>
          <dd>
            Launch again the script. The output is the following:
          </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-shell">
[DEBUG] Received 0xf bytes:
    b'Correct!\n'
    b'd = ?\n'
          </code></pre>
        </div>

        <dl>
          <dd>
            Then we need to calculate <i>d</i> which is the modular multiplicative inverse of e modulo tot(n). In order to calculate it we need to write two function which calculate the EGCD and the modular inverse itself
          </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-python">
# Euclid's Extended GCD algorithm.
def egcd(a, b):
    if a == 0:
        return b, 0, 1
    else:
        g, y, x = egcd(b % a, a)

    return g, x - (b // a) * y, y

# Modular inverse using the e-GCD algorithm.
def modinv(a, m):
    g, x, y = egcd(a, m)
    if g != 1:
        raise Exception('Modular inverse does not exist')
    else:
        return x % m

# Level 5
d = modinv(e, tot)
dev.sendline(str(d))
          </code></pre>
        </div>

        <dl>
          <dd>
            Launch again the script. The output is the following:
          </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-shell">
[DEBUG] Received 0x10 bytes:
    b'\n'
    b'd = ?\n'
    b'Correct!\n'
[DEBUG] Received 0x4e bytes:
    b'Level 5\n'
    b'p = 3774269563\n'
    b'q = 3870817141\n'
    b'e = 65537\n'
    b'c = 8011680924785520902\n'
    b'm = ?\n'
          </code></pre>
        </div>

        <dl>
          <dd>
            In the last step we need to put everything together and decrypt the message.
          </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-python">
# Level 6
    dev.recvuntil('p = ')
    p = int(dev.recvuntil('\n').decode("utf-8").replace('\n', ''))
    dev.recvuntil('q = ')
    q = int(dev.recvuntil('\n').decode("utf-8").replace('\n', ''))
    dev.recvuntil('e = ')
    e = int(dev.recvuntil('\n').decode("utf-8").replace('\n', ''))
    dev.recvuntil('c = ')
    c = int(dev.recvuntil('\n').decode("utf-8").replace('\n', ''))

    n = p * q
    tot = (p-1) * (q-1)
    d = modinv(e, tot)
    m = pow(c,d,n)
    dev.sendline(str(m))
          </code></pre>
        </div>

        <dl>
          <dd>
            Put every piece together and launch again the script give us our flag
          </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-python">
#!/usr/bin/env python3
# coding: utf-8
import sys
import time

# pip install pwn
from pwn import *

from struct import pack,unpack
from binascii import hexlify
import re

# Euclid's Extended GCD algorithm.
def egcd(a, b):
    if a == 0:
        return b, 0, 1
    else:
        g, y, x = egcd(b % a, a)

    return g, x - (b // a) * y, y

# Modular inverse using the e-GCD algorithm.
def modinv(a, m):
    g, x, y = egcd(a, m)
    if g != 1:
        raise Exception('Modular inverse does not exist')
    else:
        return x % m

def main(args):
    dev = None

    # toggle to remote with ./pwn.py remote
    dev = remote("rsa.challs.cyberchallenge.it", 7010)

    # Level 1
    dev.recvuntil('p = ')
    p = int(dev.recvuntil('\n').decode("utf-8").replace('\n', ''))

    dev.recvuntil('q = ')
    q = int(dev.recvuntil('\n').decode("utf-8").replace('\n', ''))

    n = p * q
    dev.sendline(str(n))

    # Level 2
    dev.recvuntil('message = ')
    plain = dev.recvuntil('\n').decode("utf-8").replace('\n', '')
    m = int(hexlify(plain.encode()),16)
    dev.sendline(str(m))

    # Level 3
    dev.recvuntil('p = ')
    p = int(dev.recvuntil('\n').decode("utf-8").replace('\n', ''))
    dev.recvuntil('q = ')
    q = int(dev.recvuntil('\n').decode("utf-8").replace('\n', ''))
    n = p * q
    dev.recvuntil('m = ')
    m = int(dev.recvuntil('\n').decode("utf-8").replace('\n', ''))
    dev.recvuntil('e = ')
    e = int(dev.recvuntil('\n').decode("utf-8").replace('\n', ''))

    c = pow(m,e,n)
    print(c)
    dev.sendline(str(c))

    # Level 4
    dev.recvuntil('p = ')
    p = int(dev.recvuntil('\n').decode("utf-8").replace('\n', ''))
    dev.recvuntil('q = ')
    q = int(dev.recvuntil('\n').decode("utf-8").replace('\n', ''))
    dev.recvuntil('e = ')
    e = int(dev.recvuntil('\n').decode("utf-8").replace('\n', ''))

    tot = (p-1) * (q-1)
    dev.sendline(str(tot))

    # Level 5
    d = modinv(e, tot)
    dev.sendline(str(d))

    # Level 6
    dev.recvuntil('p = ')
    p = int(dev.recvuntil('\n').decode("utf-8").replace('\n', ''))
    dev.recvuntil('q = ')
    q = int(dev.recvuntil('\n').decode("utf-8").replace('\n', ''))
    dev.recvuntil('e = ')
    e = int(dev.recvuntil('\n').decode("utf-8").replace('\n', ''))
    dev.recvuntil('c = ')
    c = int(dev.recvuntil('\n').decode("utf-8").replace('\n', ''))

    n = p * q
    tot = (p-1) * (q-1)
    d = modinv(e, tot)
    m = pow(c,d,n)
    dev.sendline(str(m))

    print(dev.recvall())
    sys.exit(0)

if __name__ == "__main__":
	main(sys.argv)

          </code></pre>
        </div>

        <div class="row-full code">
          <pre><code class="prism language-shell">
[DEBUG] Received 0x38 bytes:
    b'Correct!\n'
    b"Great! Here's your flag:\n"
    b'CCIT{W3lc0me_t0_RSA!}\n'
          </code></pre>
        </div>

        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong> CCIT{W3lc0me_t0_RSA!} </strong></p>
          </blockquote>
        </dl>
        </div>
        <hr>
<!-- Finish post  -->
<!-- Start Post  -->
        <dl class="anchor" id="decrypt-me-1">
          <dt> Decrypt me (level 1) - Points: 500 </dt>
          <dd> Decrypt me, if you can... </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-text">
n = 5582983442520038683
e = 65537
c = [4241158327675851879,4241158327675851879,5354489610922786464,
     4550738158389426310,4665662406419402733,3736594563003291531,
     323653105751856648,4703388441175874733,5363019606146104279,
     3143962585538422543,3488820451902874497,123964607634809096,
     747696344002322146,296392603807014516,5363019606146104279,
     747696344002322146,2760000353975742240,5363019606146104279,
     1022394867374906972,123964607634809096,323653105751856648,
     4183060581760535428,296392603807014516,5363019606146104279,
     4703388441175874733,323653105751856648,747696344002322146,
     3082072561190179323,323653105751856648,324335115885569813,
     3685077408869721674]
          </code></pre>
        </div>

        <dl>
          <dd>
            In order to decrypt the ciphertext we need to factorize n since it's not so big. We can do it by writing a function that calculates the prime factors of a number or just by visiting <a href="http://factordb.com/" style="color:blue;"> this online database</a>. We also need the totient and the multiplicative inverse of e. Finally we can decrypt it. Following the script:
          </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-python">
def prime_factors(n):
    i = 2
    factors = []
    while i * i <= n:
        if n % i:
            i += 1
        else:
            n //= i
            factors.append(i)
    if n > 1:
        factors.append(n)
    return factors

# Euclid's Extended GCD algorithm.
def egcd(a, b):
    if a == 0:
        return b, 0, 1
    else:
        g, y, x = egcd(b % a, a)

    return g, x - (b // a) * y, y

# Modular inverse using the e-GCD algorithm.
def modinv(a, m):
    g, x, y = egcd(a, m)
    if g != 1:
        raise Exception('Modular inverse does not exist')
    else:
        return x % m

n = 5582983442520038683
e = 65537
c = [4241158327675851879,4241158327675851879,5354489610922786464,
     4550738158389426310,4665662406419402733,3736594563003291531,
     323653105751856648,4703388441175874733,5363019606146104279,
     3143962585538422543,3488820451902874497,123964607634809096,
     747696344002322146,296392603807014516,5363019606146104279,
     747696344002322146,2760000353975742240,5363019606146104279,
     1022394867374906972,123964607634809096,323653105751856648,
     4183060581760535428,296392603807014516,5363019606146104279,
     4703388441175874733,323653105751856648,747696344002322146,
     3082072561190179323,323653105751856648,324335115885569813,
     3685077408869721674]

# Uncomment the following lines to manually calculate the prime factors
#p , q= prime_factors(n)
#print(p,q)
p = 2357345743
q = 2368334581
tot = (p-1) * (q-1)
d = modinv(e, tot)
flag = ''
for l in c:
    m = pow(l,d,n)
    print(m)
    flag += chr(m)

print(flag)
          </code></pre>
        </div>

        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong> CCIT{d3crypt_0r_brut3f0rc3_m3?} </strong></p>
          </blockquote>
        </dl>
        </div>
        <hr>
<!-- Finish post  -->
<!-- Start Post  -->
        <dl class="anchor" id="decrypt-me-2">
          <dt> Decrypt me (level 2) - Points: 500 </dt>
          <dd> Decrypt me, again! </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-text">
n = 26031365670619051180967497992735653615248347404890934345824218269609007356758359436213558544987397749139905763394532981794461894107346439762361343384342120326551201048068380348814787400805695670193337789414404331146366248495562919707471218782167067150280336303081550451712162551574033500551802662825476272375858801622708133661521990104783247450632107891796484421088373022682857006604005171035765370581741766974684151952067307835338608090515755409851655727203230079645788957814681683283537936346193824177256316048319356777956436302270437852846483514349116717560705701369062182955707730027156063882547067131269501037097
e = 65537
c = [10864477714422251994390266296396345535725051916959924389076048139896979307593665356782546799562403294814334007912864773438784067241538879058044626735313614322467284063040994020766730365859011766322294194425625221689027234416090979658832489910231552800114071331052152339054632938737996407002327169431968793683293964270630788634884580198807181478044949457555436361993170542546607398654151588064893949079634286224646113144086115790434080296714961174787839236873550485286193900004898351840805361137479730073163088526940597011665078619032310982584228325093202451424448674668514898762417398816391110905070753608735794107170,10864477714422251994390266296396345535725051916959924389076048139896979307593665356782546799562403294814334007912864773438784067241538879058044626735313614322467284063040994020766730365859011766322294194425625221689027234416090979658832489910231552800114071331052152339054632938737996407002327169431968793683293964270630788634884580198807181478044949457555436361993170542546607398654151588064893949079634286224646113144086115790434080296714961174787839236873550485286193900004898351840805361137479730073163088526940597011665078619032310982584228325093202451424448674668514898762417398816391110905070753608735794107170,21461135210195487611535416749078994947612351915946256036739087855866197749657455482152105500637280636941418567706158741883158287759122232523282858307643755959649520070711586193807395063482559416653371913510727831191187392165667299269648097763978413068205106455926580973350387939769555058883313309488620624256681806594269153663495928639643860834458801460718887093829818657286924303090386276529662400169456692855046590803979876948626314200442202081829082196066705559580776836988626611661673904104156173431966682173738357964474964859982102601386407960103395069303651989124450479400293516004986062171660082867178497669863,11690830412271188080527749795755595174867619143676059538602657921359078655813546734262244716420710365244863506664946294591305635168134076352879926496728620427128343218241639573742777938559079430667058988131041579219001676929579494066204856634236623553203749922772441737300347095769657795879067315804182641426442392059791697216486151576820047787381430279736457057945610692027175032084878506245029517122593648147316137587483856722771874026496567933159846172484495390598810819058279465227077733285579623664209985662668303621887496558658516861209211077788850733748798837049729139256185479155294621527919099682905783243452,6574633691662772985731184404511670651603868020429019303627837734091996937637155460661817515268908351349190898081404525544355831057621375182259626444786267137036780572928066905152922783093116100198090465346888597360307633697742341269782028263659566528661506056942775743712742333328663574455793239337463112282991265133228765856623655349299251606888415130833712342657727864547838743070502066087205662351633410276169873158656172597651814860065728569170309219440861381060735021755965210454910877526545417069985302351233760105847461734589264071410213712381216063088471365790682143425154935867894619832439348130793156142233,13798621592577793944005192599019813232697016746886548534902166188004839619923956329587780235770688484797964428641237630399002794722287864505966932933281710290381525616265488281707334113863802152504159383477394105692647501587323962580635988260283628324939031183799248185860919594399959968979071195451648837069127033690802716095806056014875442238860014999886960962458840217456731147061769456334021251899919384594707008863081546747239575539135134861347195528245769752930171714368071818216649900686025691661476536711167454534844972905432583039884691748345300862071340364984833607116078599308869735155766466728834358561985,21274472534381325454558676153183781287264098064833627596051796756718518619179190677452677820811367567954898728975650934285083887888743489108069043911350095635434743009406835602039179881679048701416424166882784074226682275789207741226018629156206319116386301325664542694095840983595464846618039099628955756304127335153590511875166227146773120274393554926883193576683629153692746469081502471820466332297965132068589386605813754583296733821987052559641795580048841788816094067723625654848825847322953789189770063926881613869527915699875776208596039728709668926072761786777417125086042663844093646809927107093186660165998,12744877102192770970523101838761673021244262637448229715039647382104092343105733178880372989995601058613966323792583374153909218869908403357794702532546292040471826766945664020694861204934525745178775560745068238095111260660923798529864433286525988163706619947908087571435662962510438542292725732237912306414295678020861712672734014710555773929287342838147009019158488416157800195959512337384159436390033352013155167601497666177688599600003110171258041308567195422227687470803173755525878728837410640013366393980122156655725127347826284659102753760323535718113266031334594732510678796211831877699164447935546741371081,13674786691575495832377891341898946343413263905717511973487576676476402992050465170152405537647247739475634972014216640537550312410762671310093303955668751883267765341743361600214315356163303705142881005367445047882666508009239756795088414349353587700021039519182644837015916076874008112864991557148637142861541432544938986163430065422660846261670105214124094188464073669655266108890550654438584500622882020337727744997131566222718484069184053944427196447206302487414117435957518899211246372444357583088478365975110313038237775035704512193927459782435018281032628784080514455006064836774633168277212324604227817372454,15724273564713207129529836191590296044915642156557303918506854187212609053146450109431219060991054710901078702469058580740463194754009712922330854713200913551016228375873937415222450139689221982681585190090167633624191521231463736510392000026764520847794538950534227239794010111536301975348757503592783983955144709866433769543508872621366447341607368701531334044198937480608913995491705040091342051191399234451947107473473568490146008442688478598386944150353050550365228660095837783495568316501843548903647255666941501383714347451164047256523480491574480910011570264156484821865657077446243174515542016535279606712081,13886185099447040570826288960166422704775831741758275473829134506469667156742420104003806157429640610839170370203577250400122857230779002489415718302858063086284836857949601007117746375708584185992752103431220356416587958406599232249821420559158994397870381812933167988346668231184075194958660790066785699884500308623721405966023272737176757078713404569647271849992920409877332612834098756861104229555180643780318083139625477196511133627519254045436390767126741763004010376903939485952315204046444266386746354280191358427078334704061528168050730311162665220776226827857673460193398814697806136099714150135565601446893,21924361269778339837858684542898421626187414921569327737997192109082961149648700900828802075064324914318260339168389506397034403335145538935517214624692205922857433319491884358410190104415454437461658637359181989639974345738395085722713451177881389949534500167431935935256392224977137978519171209752194631144672901025941777577700579898163987152364406282989581335838840842405867718789406786698178430846854459760920000794663242250569811498570767681805814182122711831086716341003941023779766851395058519831682712560954012254181399062505931509058026289940311919459558591110825516531521648178210133292036944824417882440725,10580517172461898490076891487370751385115081475340219385156301375091412124496344669213552968964287302473649470867264593659207047520116786470291163387208863777074995286703628424464960479342371932575675669263730815708418134523368003980267145615492370026961057396754163915553638930999492909077122566196669497944902935593223616672055015294200505904232177493630095114325531795121044413888101500162554129017683820899690051332641211586491511853520349693689737361207654549058309382639057671439931351772576001851393142049976314969577380887821022648519402199451476051336916063817522133729173303887105543806621569641949752384865,17166313480486892931530696678305096707058558260518357093206709578758292324703840875618657125470925976339329660213081477534290480799586512408372781587150874823116666029246786970023054014929974157366102980117046853576425369166091725488067231168116526769327913063807151982644908513984610778614057608310099112779187201654982293952153441880726729219226717841673213844197025185261266966485482670463402957749538243883899863551852948077811910019292307641298504400245929073210116241136948633757298094426314323316645473814200433094689773068942748572060093737454056316107510563121565884252513833889713417280546340586116332430586,13674786691575495832377891341898946343413263905717511973487576676476402992050465170152405537647247739475634972014216640537550312410762671310093303955668751883267765341743361600214315356163303705142881005367445047882666508009239756795088414349353587700021039519182644837015916076874008112864991557148637142861541432544938986163430065422660846261670105214124094188464073669655266108890550654438584500622882020337727744997131566222718484069184053944427196447206302487414117435957518899211246372444357583088478365975110313038237775035704512193927459782435018281032628784080514455006064836774633168277212324604227817372454,10580517172461898490076891487370751385115081475340219385156301375091412124496344669213552968964287302473649470867264593659207047520116786470291163387208863777074995286703628424464960479342371932575675669263730815708418134523368003980267145615492370026961057396754163915553638930999492909077122566196669497944902935593223616672055015294200505904232177493630095114325531795121044413888101500162554129017683820899690051332641211586491511853520349693689737361207654549058309382639057671439931351772576001851393142049976314969577380887821022648519402199451476051336916063817522133729173303887105543806621569641949752384865,21274472534381325454558676153183781287264098064833627596051796756718518619179190677452677820811367567954898728975650934285083887888743489108069043911350095635434743009406835602039179881679048701416424166882784074226682275789207741226018629156206319116386301325664542694095840983595464846618039099628955756304127335153590511875166227146773120274393554926883193576683629153692746469081502471820466332297965132068589386605813754583296733821987052559641795580048841788816094067723625654848825847322953789189770063926881613869527915699875776208596039728709668926072761786777417125086042663844093646809927107093186660165998,11374623997972776726654847695599420112953801511225717796634459669479154231652869034775109863567026419466590195475306518639428910921343670329872647584975909172138565613985303108046226145018686563616989143618550135009663855849958150356224180694413173985996967102823173475225854809359839706558308157757848985685039452827948781777503737807453268105131997618920417556207149563974484618029885579555003842842727519538633314485150289844636034192260429147898802957426713770533569517124244205102149846727964163042304710522611733716572632424120622000011055837793014582647236096405057850345003167193833180552798706604212594428206,12744877102192770970523101838761673021244262637448229715039647382104092343105733178880372989995601058613966323792583374153909218869908403357794702532546292040471826766945664020694861204934525745178775560745068238095111260660923798529864433286525988163706619947908087571435662962510438542292725732237912306414295678020861712672734014710555773929287342838147009019158488416157800195959512337384159436390033352013155167601497666177688599600003110171258041308567195422227687470803173755525878728837410640013366393980122156655725127347826284659102753760323535718113266031334594732510678796211831877699164447935546741371081,13674786691575495832377891341898946343413263905717511973487576676476402992050465170152405537647247739475634972014216640537550312410762671310093303955668751883267765341743361600214315356163303705142881005367445047882666508009239756795088414349353587700021039519182644837015916076874008112864991557148637142861541432544938986163430065422660846261670105214124094188464073669655266108890550654438584500622882020337727744997131566222718484069184053944427196447206302487414117435957518899211246372444357583088478365975110313038237775035704512193927459782435018281032628784080514455006064836774633168277212324604227817372454,15724273564713207129529836191590296044915642156557303918506854187212609053146450109431219060991054710901078702469058580740463194754009712922330854713200913551016228375873937415222450139689221982681585190090167633624191521231463736510392000026764520847794538950534227239794010111536301975348757503592783983955144709866433769543508872621366447341607368701531334044198937480608913995491705040091342051191399234451947107473473568490146008442688478598386944150353050550365228660095837783495568316501843548903647255666941501383714347451164047256523480491574480910011570264156484821865657077446243174515542016535279606712081,13886185099447040570826288960166422704775831741758275473829134506469667156742420104003806157429640610839170370203577250400122857230779002489415718302858063086284836857949601007117746375708584185992752103431220356416587958406599232249821420559158994397870381812933167988346668231184075194958660790066785699884500308623721405966023272737176757078713404569647271849992920409877332612834098756861104229555180643780318083139625477196511133627519254045436390767126741763004010376903939485952315204046444266386746354280191358427078334704061528168050730311162665220776226827857673460193398814697806136099714150135565601446893,21924361269778339837858684542898421626187414921569327737997192109082961149648700900828802075064324914318260339168389506397034403335145538935517214624692205922857433319491884358410190104415454437461658637359181989639974345738395085722713451177881389949534500167431935935256392224977137978519171209752194631144672901025941777577700579898163987152364406282989581335838840842405867718789406786698178430846854459760920000794663242250569811498570767681805814182122711831086716341003941023779766851395058519831682712560954012254181399062505931509058026289940311919459558591110825516531521648178210133292036944824417882440725,10580517172461898490076891487370751385115081475340219385156301375091412124496344669213552968964287302473649470867264593659207047520116786470291163387208863777074995286703628424464960479342371932575675669263730815708418134523368003980267145615492370026961057396754163915553638930999492909077122566196669497944902935593223616672055015294200505904232177493630095114325531795121044413888101500162554129017683820899690051332641211586491511853520349693689737361207654549058309382639057671439931351772576001851393142049976314969577380887821022648519402199451476051336916063817522133729173303887105543806621569641949752384865,481358742795269565268574259969931737374772777608042714086620047758539932891508080337150847465580569532299504443039667903377043336455874184709564831809158542725787259804359820751565305779057479155206207737705029676602312168499266383663658174839672821187998574292067312428697260012954580172824837677917343024174421004637566774138262477002684158010275115647706740099663411762700953303260515208097923728582482597241199630974724821273640718386531418506459278824858179000464486900898665450817102753023664131282983494872260859300726937070088992186977098382314364611425678842576044086218830662579895012304158929139473635702,21274472534381325454558676153183781287264098064833627596051796756718518619179190677452677820811367567954898728975650934285083887888743489108069043911350095635434743009406835602039179881679048701416424166882784074226682275789207741226018629156206319116386301325664542694095840983595464846618039099628955756304127335153590511875166227146773120274393554926883193576683629153692746469081502471820466332297965132068589386605813754583296733821987052559641795580048841788816094067723625654848825847322953789189770063926881613869527915699875776208596039728709668926072761786777417125086042663844093646809927107093186660165998,18966588066537550803399991594883980365140838756475995193841407730365241922225287135314188118879536934293790503786716454403873390044252778456126504992437867897363145175733704706133207863626907226905807433913216626522137033294129021272321845767827604270657035685654560654435267634836524200903136200171453543309989895081700219622103633649670821949363395534495533314692977953667504047435007368013668465212155387407951638204234369456724713204843765578681164516815107865460556076797797142627327966505138143471876332397609402054609961074394776944356919133364539381204766369312926411829090269438850895473604256451429504595882,16989172052368168192940449157317777647516063498798465020099695648681656448945395896875355399320633957007938149743656263569954690740264378101375179011120689064572762009166532475226591210094528682152995461772379922833561106640547875805998113587332232693189417609809613058661097182378348890250833614443244616132289270602893417544659058361169519418312449549254870559933585321232533063644486168311951577220739207860988283103530876960051710527420596650733218127837689114900312304080358280904541621734390107632162255813905466930377449497267212931666838588276666851440085997303212483471617138425168526226417299309470407521793]
          </code></pre>
        </div>

        <dl>
          <dd>
            This time since n is big, we cannot obtain it in a fast way. What we can do here, since the cipher is composed by each letter separated from a <code>,</code> we can try for each character in <code>c</code> to encrypt each printable character and see if  they match.
            Let's write a script for it.
          </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-python">
import string

n = 26031365670619051180967497992735653615248347404890934345824218269609007356758359436213558544987397749139905763394532981794461894107346439762361343384342120326551201048068380348814787400805695670193337789414404331146366248495562919707471218782167067150280336303081550451712162551574033500551802662825476272375858801622708133661521990104783247450632107891796484421088373022682857006604005171035765370581741766974684151952067307835338608090515755409851655727203230079645788957814681683283537936346193824177256316048319356777956436302270437852846483514349116717560705701369062182955707730027156063882547067131269501037097
e = 65537
c = [10864477714422251994390266296396345535725051916959924389076048139896979307593665356782546799562403294814334007912864773438784067241538879058044626735313614322467284063040994020766730365859011766322294194425625221689027234416090979658832489910231552800114071331052152339054632938737996407002327169431968793683293964270630788634884580198807181478044949457555436361993170542546607398654151588064893949079634286224646113144086115790434080296714961174787839236873550485286193900004898351840805361137479730073163088526940597011665078619032310982584228325093202451424448674668514898762417398816391110905070753608735794107170,10864477714422251994390266296396345535725051916959924389076048139896979307593665356782546799562403294814334007912864773438784067241538879058044626735313614322467284063040994020766730365859011766322294194425625221689027234416090979658832489910231552800114071331052152339054632938737996407002327169431968793683293964270630788634884580198807181478044949457555436361993170542546607398654151588064893949079634286224646113144086115790434080296714961174787839236873550485286193900004898351840805361137479730073163088526940597011665078619032310982584228325093202451424448674668514898762417398816391110905070753608735794107170,21461135210195487611535416749078994947612351915946256036739087855866197749657455482152105500637280636941418567706158741883158287759122232523282858307643755959649520070711586193807395063482559416653371913510727831191187392165667299269648097763978413068205106455926580973350387939769555058883313309488620624256681806594269153663495928639643860834458801460718887093829818657286924303090386276529662400169456692855046590803979876948626314200442202081829082196066705559580776836988626611661673904104156173431966682173738357964474964859982102601386407960103395069303651989124450479400293516004986062171660082867178497669863,11690830412271188080527749795755595174867619143676059538602657921359078655813546734262244716420710365244863506664946294591305635168134076352879926496728620427128343218241639573742777938559079430667058988131041579219001676929579494066204856634236623553203749922772441737300347095769657795879067315804182641426442392059791697216486151576820047787381430279736457057945610692027175032084878506245029517122593648147316137587483856722771874026496567933159846172484495390598810819058279465227077733285579623664209985662668303621887496558658516861209211077788850733748798837049729139256185479155294621527919099682905783243452,6574633691662772985731184404511670651603868020429019303627837734091996937637155460661817515268908351349190898081404525544355831057621375182259626444786267137036780572928066905152922783093116100198090465346888597360307633697742341269782028263659566528661506056942775743712742333328663574455793239337463112282991265133228765856623655349299251606888415130833712342657727864547838743070502066087205662351633410276169873158656172597651814860065728569170309219440861381060735021755965210454910877526545417069985302351233760105847461734589264071410213712381216063088471365790682143425154935867894619832439348130793156142233,13798621592577793944005192599019813232697016746886548534902166188004839619923956329587780235770688484797964428641237630399002794722287864505966932933281710290381525616265488281707334113863802152504159383477394105692647501587323962580635988260283628324939031183799248185860919594399959968979071195451648837069127033690802716095806056014875442238860014999886960962458840217456731147061769456334021251899919384594707008863081546747239575539135134861347195528245769752930171714368071818216649900686025691661476536711167454534844972905432583039884691748345300862071340364984833607116078599308869735155766466728834358561985,21274472534381325454558676153183781287264098064833627596051796756718518619179190677452677820811367567954898728975650934285083887888743489108069043911350095635434743009406835602039179881679048701416424166882784074226682275789207741226018629156206319116386301325664542694095840983595464846618039099628955756304127335153590511875166227146773120274393554926883193576683629153692746469081502471820466332297965132068589386605813754583296733821987052559641795580048841788816094067723625654848825847322953789189770063926881613869527915699875776208596039728709668926072761786777417125086042663844093646809927107093186660165998,12744877102192770970523101838761673021244262637448229715039647382104092343105733178880372989995601058613966323792583374153909218869908403357794702532546292040471826766945664020694861204934525745178775560745068238095111260660923798529864433286525988163706619947908087571435662962510438542292725732237912306414295678020861712672734014710555773929287342838147009019158488416157800195959512337384159436390033352013155167601497666177688599600003110171258041308567195422227687470803173755525878728837410640013366393980122156655725127347826284659102753760323535718113266031334594732510678796211831877699164447935546741371081,13674786691575495832377891341898946343413263905717511973487576676476402992050465170152405537647247739475634972014216640537550312410762671310093303955668751883267765341743361600214315356163303705142881005367445047882666508009239756795088414349353587700021039519182644837015916076874008112864991557148637142861541432544938986163430065422660846261670105214124094188464073669655266108890550654438584500622882020337727744997131566222718484069184053944427196447206302487414117435957518899211246372444357583088478365975110313038237775035704512193927459782435018281032628784080514455006064836774633168277212324604227817372454,15724273564713207129529836191590296044915642156557303918506854187212609053146450109431219060991054710901078702469058580740463194754009712922330854713200913551016228375873937415222450139689221982681585190090167633624191521231463736510392000026764520847794538950534227239794010111536301975348757503592783983955144709866433769543508872621366447341607368701531334044198937480608913995491705040091342051191399234451947107473473568490146008442688478598386944150353050550365228660095837783495568316501843548903647255666941501383714347451164047256523480491574480910011570264156484821865657077446243174515542016535279606712081,13886185099447040570826288960166422704775831741758275473829134506469667156742420104003806157429640610839170370203577250400122857230779002489415718302858063086284836857949601007117746375708584185992752103431220356416587958406599232249821420559158994397870381812933167988346668231184075194958660790066785699884500308623721405966023272737176757078713404569647271849992920409877332612834098756861104229555180643780318083139625477196511133627519254045436390767126741763004010376903939485952315204046444266386746354280191358427078334704061528168050730311162665220776226827857673460193398814697806136099714150135565601446893,21924361269778339837858684542898421626187414921569327737997192109082961149648700900828802075064324914318260339168389506397034403335145538935517214624692205922857433319491884358410190104415454437461658637359181989639974345738395085722713451177881389949534500167431935935256392224977137978519171209752194631144672901025941777577700579898163987152364406282989581335838840842405867718789406786698178430846854459760920000794663242250569811498570767681805814182122711831086716341003941023779766851395058519831682712560954012254181399062505931509058026289940311919459558591110825516531521648178210133292036944824417882440725,10580517172461898490076891487370751385115081475340219385156301375091412124496344669213552968964287302473649470867264593659207047520116786470291163387208863777074995286703628424464960479342371932575675669263730815708418134523368003980267145615492370026961057396754163915553638930999492909077122566196669497944902935593223616672055015294200505904232177493630095114325531795121044413888101500162554129017683820899690051332641211586491511853520349693689737361207654549058309382639057671439931351772576001851393142049976314969577380887821022648519402199451476051336916063817522133729173303887105543806621569641949752384865,17166313480486892931530696678305096707058558260518357093206709578758292324703840875618657125470925976339329660213081477534290480799586512408372781587150874823116666029246786970023054014929974157366102980117046853576425369166091725488067231168116526769327913063807151982644908513984610778614057608310099112779187201654982293952153441880726729219226717841673213844197025185261266966485482670463402957749538243883899863551852948077811910019292307641298504400245929073210116241136948633757298094426314323316645473814200433094689773068942748572060093737454056316107510563121565884252513833889713417280546340586116332430586,13674786691575495832377891341898946343413263905717511973487576676476402992050465170152405537647247739475634972014216640537550312410762671310093303955668751883267765341743361600214315356163303705142881005367445047882666508009239756795088414349353587700021039519182644837015916076874008112864991557148637142861541432544938986163430065422660846261670105214124094188464073669655266108890550654438584500622882020337727744997131566222718484069184053944427196447206302487414117435957518899211246372444357583088478365975110313038237775035704512193927459782435018281032628784080514455006064836774633168277212324604227817372454,10580517172461898490076891487370751385115081475340219385156301375091412124496344669213552968964287302473649470867264593659207047520116786470291163387208863777074995286703628424464960479342371932575675669263730815708418134523368003980267145615492370026961057396754163915553638930999492909077122566196669497944902935593223616672055015294200505904232177493630095114325531795121044413888101500162554129017683820899690051332641211586491511853520349693689737361207654549058309382639057671439931351772576001851393142049976314969577380887821022648519402199451476051336916063817522133729173303887105543806621569641949752384865,21274472534381325454558676153183781287264098064833627596051796756718518619179190677452677820811367567954898728975650934285083887888743489108069043911350095635434743009406835602039179881679048701416424166882784074226682275789207741226018629156206319116386301325664542694095840983595464846618039099628955756304127335153590511875166227146773120274393554926883193576683629153692746469081502471820466332297965132068589386605813754583296733821987052559641795580048841788816094067723625654848825847322953789189770063926881613869527915699875776208596039728709668926072761786777417125086042663844093646809927107093186660165998,11374623997972776726654847695599420112953801511225717796634459669479154231652869034775109863567026419466590195475306518639428910921343670329872647584975909172138565613985303108046226145018686563616989143618550135009663855849958150356224180694413173985996967102823173475225854809359839706558308157757848985685039452827948781777503737807453268105131997618920417556207149563974484618029885579555003842842727519538633314485150289844636034192260429147898802957426713770533569517124244205102149846727964163042304710522611733716572632424120622000011055837793014582647236096405057850345003167193833180552798706604212594428206,12744877102192770970523101838761673021244262637448229715039647382104092343105733178880372989995601058613966323792583374153909218869908403357794702532546292040471826766945664020694861204934525745178775560745068238095111260660923798529864433286525988163706619947908087571435662962510438542292725732237912306414295678020861712672734014710555773929287342838147009019158488416157800195959512337384159436390033352013155167601497666177688599600003110171258041308567195422227687470803173755525878728837410640013366393980122156655725127347826284659102753760323535718113266031334594732510678796211831877699164447935546741371081,13674786691575495832377891341898946343413263905717511973487576676476402992050465170152405537647247739475634972014216640537550312410762671310093303955668751883267765341743361600214315356163303705142881005367445047882666508009239756795088414349353587700021039519182644837015916076874008112864991557148637142861541432544938986163430065422660846261670105214124094188464073669655266108890550654438584500622882020337727744997131566222718484069184053944427196447206302487414117435957518899211246372444357583088478365975110313038237775035704512193927459782435018281032628784080514455006064836774633168277212324604227817372454,15724273564713207129529836191590296044915642156557303918506854187212609053146450109431219060991054710901078702469058580740463194754009712922330854713200913551016228375873937415222450139689221982681585190090167633624191521231463736510392000026764520847794538950534227239794010111536301975348757503592783983955144709866433769543508872621366447341607368701531334044198937480608913995491705040091342051191399234451947107473473568490146008442688478598386944150353050550365228660095837783495568316501843548903647255666941501383714347451164047256523480491574480910011570264156484821865657077446243174515542016535279606712081,13886185099447040570826288960166422704775831741758275473829134506469667156742420104003806157429640610839170370203577250400122857230779002489415718302858063086284836857949601007117746375708584185992752103431220356416587958406599232249821420559158994397870381812933167988346668231184075194958660790066785699884500308623721405966023272737176757078713404569647271849992920409877332612834098756861104229555180643780318083139625477196511133627519254045436390767126741763004010376903939485952315204046444266386746354280191358427078334704061528168050730311162665220776226827857673460193398814697806136099714150135565601446893,21924361269778339837858684542898421626187414921569327737997192109082961149648700900828802075064324914318260339168389506397034403335145538935517214624692205922857433319491884358410190104415454437461658637359181989639974345738395085722713451177881389949534500167431935935256392224977137978519171209752194631144672901025941777577700579898163987152364406282989581335838840842405867718789406786698178430846854459760920000794663242250569811498570767681805814182122711831086716341003941023779766851395058519831682712560954012254181399062505931509058026289940311919459558591110825516531521648178210133292036944824417882440725,10580517172461898490076891487370751385115081475340219385156301375091412124496344669213552968964287302473649470867264593659207047520116786470291163387208863777074995286703628424464960479342371932575675669263730815708418134523368003980267145615492370026961057396754163915553638930999492909077122566196669497944902935593223616672055015294200505904232177493630095114325531795121044413888101500162554129017683820899690051332641211586491511853520349693689737361207654549058309382639057671439931351772576001851393142049976314969577380887821022648519402199451476051336916063817522133729173303887105543806621569641949752384865,481358742795269565268574259969931737374772777608042714086620047758539932891508080337150847465580569532299504443039667903377043336455874184709564831809158542725787259804359820751565305779057479155206207737705029676602312168499266383663658174839672821187998574292067312428697260012954580172824837677917343024174421004637566774138262477002684158010275115647706740099663411762700953303260515208097923728582482597241199630974724821273640718386531418506459278824858179000464486900898665450817102753023664131282983494872260859300726937070088992186977098382314364611425678842576044086218830662579895012304158929139473635702,21274472534381325454558676153183781287264098064833627596051796756718518619179190677452677820811367567954898728975650934285083887888743489108069043911350095635434743009406835602039179881679048701416424166882784074226682275789207741226018629156206319116386301325664542694095840983595464846618039099628955756304127335153590511875166227146773120274393554926883193576683629153692746469081502471820466332297965132068589386605813754583296733821987052559641795580048841788816094067723625654848825847322953789189770063926881613869527915699875776208596039728709668926072761786777417125086042663844093646809927107093186660165998,18966588066537550803399991594883980365140838756475995193841407730365241922225287135314188118879536934293790503786716454403873390044252778456126504992437867897363145175733704706133207863626907226905807433913216626522137033294129021272321845767827604270657035685654560654435267634836524200903136200171453543309989895081700219622103633649670821949363395534495533314692977953667504047435007368013668465212155387407951638204234369456724713204843765578681164516815107865460556076797797142627327966505138143471876332397609402054609961074394776944356919133364539381204766369312926411829090269438850895473604256451429504595882,16989172052368168192940449157317777647516063498798465020099695648681656448945395896875355399320633957007938149743656263569954690740264378101375179011120689064572762009166532475226591210094528682152995461772379922833561106640547875805998113587332232693189417609809613058661097182378348890250833614443244616132289270602893417544659058361169519418312449549254870559933585321232533063644486168311951577220739207860988283103530876960051710527420596650733218127837689114900312304080358280904541621734390107632162255813905466930377449497267212931666838588276666851440085997303212483471617138425168526226417299309470407521793]

flag = ''
PRINTABLE = string.printable[:-6]

for l in c:
    for p in PRINTABLE:
        enc = pow(ord(p),e,n)
        if enc == l:
            flag += p

print(flag)
          </code></pre>
        </div>

        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong> CCIT{d3crypt_0r_3ncrypt_m3?} </strong></p>
          </blockquote>
        </dl>
        </div>
        <hr>
<!-- Finish post  -->
<!-- Start Post  -->
        <dl class="anchor" id="oracle-1">
          <dt> Oracle (level 1) - Points: 500 </dt>
          <dd> A 4 levels RSA challenge, from easy to hard. <br>
               Let's start with level 1... <br>
               This is a remote challenge, you can connect to the service with: <br>
               <code> nc oracle1.challs.cyberchallenge.it 7011 </code> <br> <br>
               The script on the server is the following:
          </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-python">
#!/usr/bin/env python3

import signal
from binascii import hexlify
from Crypto.PublicKey import RSA
from Crypto.Util.number import *
from random import randint
from secret import FLAG
import string

TIMEOUT = 300 # 5 minutes time-out

def menu():
    print()
    print('Choice:')
    print('  [0] Exit')
    print('  [1] Encrypt')
    print('  [2] Decrypt')
    print('')
    return input('> ')

def encrypt(m):
    return pow(m, rsa.e, rsa.n)

def decrypt(c):
    return pow(c, rsa.d, rsa.n)

rsa = RSA.generate(1024)
flag_encrypted = pow(bytes_to_long(FLAG.encode()), rsa.e, rsa.n)
used = [bytes_to_long(FLAG.encode())]

def handle():
  print("================================================================================")
  print("=                      RSA Encryption & Decryption oracle                      =")
  print("=                                Find the flag!                                =")
  print("================================================================================")
  print("")
  print("Encrypted flag:", flag_encrypted)

  while True:
    choice = menu()

    # Exit
    if choice == '0':
      print("Goodbye!")
      break

    # Encrypt
    elif choice == '1':
      m = int(input('\nPlaintext > ').strip())
      print('\nEncrypted: ' + str(encrypt(m)))

    # Decrypt
    elif choice == '2':
      c = int(input('\nCiphertext > ').strip())

      if c == flag_encrypted:
        print("Wait. That's illegal.")
      else:
        m = decrypt(c)
        print('\nDecrypted: ' + str(m))

    # Invalid
    else:
      print('bye!')
      break

if __name__ == "__main__":
    signal.alarm(TIMEOUT)
    handle()

          </code></pre>
        </div>

          <dl>
            <dd>
              This time we are in front of a server which manage only long numbers. This is a well-known attack on RSA called <b>Chosen cipher</b>. In order to perform this attack we need to choose a random value at the power of e, in this case we chose the encrypted flag because we didn't know e even if we could have supposed it equal to 65537. The next step is multiply our cipher for the value choosen and finally send it. What we get back is the cipher multiply for the value chosen at the power of ed modulus n. We know that computing the power to ed is equal to the message itself, then we can simply decrypt the cipher. Since we chose the encripted flag itself as a value, we can now simply do the square root and retrieve the flag by transforming the long number into bytes:
              <ol>
                <li> 1. Send \(\;c\;' = (m^e \cdot \Gamma^ e )\; mod N\)</li>
                <li> 2. Receive \(\;(m \cdot \Gamma)^{ed}\; mod N = (m \cdot \Gamma)^{ed} = m \cdot \Gamma\) </li>
                <li> 3. To get m \(\; \frac{m \cdot \Gamma}{\Gamma} = m\) </li>
              </ol>
            </dd>
          </dl>

          <div class="row-full code">
            <pre><code class="prism language-python">
#!/usr/bin/env python3
# coding: utf-8
import sys
import time

# pip install pwn
from pwn import *
from Crypto.PublicKey import RSA
from Crypto.Util.number import *

from struct import pack,unpack
from binascii import hexlify
import gmpy2

# Used for delaying after a send vs. a read
# You may not need this
def delay(name):
	if name != "":
		print("[+] Stage: '%s'" % name)
	time.sleep(0.8) # There MUST be a delay due to setvbuf in read()

def main(args):
    dev = None
    dev = remote("oracle1.challs.cyberchallenge.it", 7011)

    dev.recvuntil('Encrypted flag: ')
    enc_flag = int(dev.recvuntil('\n').decode("utf-8").replace('\n', ''))
    #print(enc_flag)

    myflag = enc_flag * enc_flag
    dev.recvuntil('>')
    dev.sendline(str(2))
    dev.recvuntil('Ciphertext > ')
    dev.sendline(str(myflag))

    dev.recvuntil('\nDecrypted: ')
    double_enc_flag = int(dev.recvuntil('\n').decode("utf-8").replace('\n', ''))
    #print(double_enc_flag)

    flag_ =gmpy2.mpz(double_enc_flag)
    print(flag_)
    gmpy2.get_context().precision=2048
    flag = gmpy2.sqrt(flag_)
    print(long_to_bytes(flag))

    # Note that if your program never ends, you will never see any output
    print(dev.recvall())
    sys.exit(0)

if __name__ == "__main__":
	main(sys.argv)
            </code></pre>
          </div>

        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong> CCIT{d3crypt_0r_brut3f0rc3_m3?} </strong></p>
          </blockquote>
        </dl>
        </div>
        <hr>
<!-- Finish post  -->


















<!-- Start Post  -->
        <dl class="anchor" id="key-exchange">
          <dt> Key Exchange - Points: 500 </dt>
          <dd> We need someone in the middle. <br>
            <code> http://keyexchange.challs.cyberchallenge.it/</code>
          </dd>
        </dl>

        <dl>
          <dd>
            You are Alice. Santa has the flag but he will disclose it only to Bob. To authenticate a client C, Santa uses the cryptographic protocol shwon in the figure where: <br> <br>
            <ul>
              <li> Ks is a public key of S </li>
              <li> Pc is the password of C </li>
            </ul>
          </dd>
        </dl>

          <div class="fig-container">
            <figure class="zoom" onmousemove="zoom(event)"
            style="background-image: url('img/8-01-key_exchange.png')" >
              <img src="img/8-01-key_exchange.png" alt="" />
            </figure>
          </div>
          <br>

        <dl>
          <dd>
             Clearly S has the means to verify the correctness of the password provided by C. Notice that the protocol is initiated by S. <br>
             You password is "Blitzen" (without quotes). <br>
             You do not know the password of Bob. <br>
          </dd>
        </dl>

        <dl>
          <blockquote>
            <p><strong>Note:</strong> When cutting and pasting data into the forms, please check you do not inadvertently add trailing spaces.</p>
          </blockquote>
        </dl>

        <dl>
          <dd>
            This is your Public Key.
          </dd>
        </dl>
        <div class="row-full code">
          <pre><code class="prism language-text">
-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCoSnsclIaWY4Mbp8arjQ8mp9zd
e6biFlrT7PEusLtbWAuLvYV97r2q4CwpS0sAsPbo91M1Jj/4KXDfb4UQ3oAZakyl
ASUNAbgV6+Tw3fX+PMf4hCgSN9eNskoKRexhxrt+JtfKHwu9CFeSYscV0RNS+3m9
Um3BWHrenw64eihZywIDAQAB
-----END PUBLIC KEY-----
          </code></pre>
        </div>

        <dl>
          <dd>
            This is your Private Key.
          </dd>
        </dl>
        <div class="row-full code">
          <pre><code class="prism language-text">
-----BEGIN RSA PRIVATE KEY-----
MIICXQIBAAKBgQCoSnsclIaWY4Mbp8arjQ8mp9zde6biFlrT7PEusLtbWAuLvYV9
7r2q4CwpS0sAsPbo91M1Jj/4KXDfb4UQ3oAZakylASUNAbgV6+Tw3fX+PMf4hCgS
N9eNskoKRexhxrt+JtfKHwu9CFeSYscV0RNS+3m9Um3BWHrenw64eihZywIDAQAB
AoGBAKUOL8LvNTVIsm0sV2En/0UlfCzKOvohfMG/8Sie85L6PpC2t7e0sNdn+Egj
7ZLm/bOt5zEIq9LkKi0qfnL2FuG+vFNaBAkHNXnyyYKPVUVucbnUWJx2c/O8sxpp
wjZJD1esEaKDfiVk1/BNYaE8VNjFuMaW3dKwT8riVhNsr/u5AkEA2oXuWSF/61JG
9dwAyKfBHz/BtdQ53eHIISkX/U6Kj4BEMEK23WebrVPz96OWr1/llum7zCbcI6b2
Ko6mVXjx1QJBAMUnJdRrjYVIo1hElhXbHSu2zagikzv66q3/E5magcbFhmD7CBeb
wUeGcKW3pySDK/g+waFn5vpoHSFtkF2uTR8CQAx14J5ye5HWkjdIwT6v2iJHB2uv
21DcpAXICxclmF8QaFL8KuM7GjRq+hlf2aLMbBIL5+p/OMRLq/PHSJLNH7UCQEV7
Y4i2kvzLOc4s9dwkCebTGS3Naah06OqDgCvdWSltict6DUMMwJRtnBu7WuuyUve9
Xk59KNlNgh6612s8t68CQQC54eVLoso+W7vM/G9110SZvWtm2vC7maJbbz+6d3px
nV6mjxmR2638eKLgQLJGw3wFX3SqWYBYU0+kM1b2wOMl
-----END RSA PRIVATE KEY-----
          </code></pre>
        </div>

        <dl>
          <dd>
            The first thing to do here is to get the Public Key of Santa. In order to obtein just send a message to Santa through the interaction panel. That's the output
          </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-text">
Hello! This is Santa server!
My public key is:

-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDh+G+5W2m6bQu5iAhiPsSS0YvJ
IPGNZ8JRhdZXSaqLnRw7I6eHc31XeC/9s9zzrSVDPrR33F13e2uTsdt8sYPusy3h
S6Zx9DPMOsi0+ZUmV0F10QAI//Kwm8NmbzLaS/sxYrA3scrPxwL8vyHwEXgo4spx
kK95AfPn2q723BoufQIDAQAB
-----END PUBLIC KEY-----
          </code></pre>
        </div>

        <dl>
          <dd>
            Next, we can send Bob some message in the form <b>message*K_Alice</b>. Please note that if you would have used a different public key you would not have been able to recover the information since the only private key we have is the Alice one.
          </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-text">
Hello ciao! This is Bob.

Encrypted Session Key: jnPJfcThG+QHhHdYim5l/DXqNRXUAtahbI/zQLO/U3UF7GE6pufajkKZEdyjhWFl1QMk/m130VITASAwDQsl3RAovVdcVSo/jF6J9WxRXjt7A0MDkxlxH7PI2CeUF04Tjn13gKqoMLLQtDgvVNr8QlQ8ncl/RKXMKI5DAD1onUo=

Encrypted Credentials: Sm8rTVE0dk5mRzBPRFJ6dGkrNEVXZz09
          </code></pre>
        </div>

        <dl>
          <dd>
            So we got an encryption section key and some credentials which are encrypted. In order to decrypt them, first, we need to use the Private Key of Alice (that's the reason why we used the Public Key of Alice before) to decrypt the encrypted session key using the <i>Public Key Decryptor</i> and, then, using the so extracted key we can decrypt the encrypted credentials using the <i>Symmetric Decryptor</i>
          </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-text">
Plaintext of session key: k+qrAs2o2tyGwCjB
Plaintext of credentials: Bob Donner-2019
          </code></pre>
        </div>

        <dl>
          <dd>
            Since the only one who can read the flag is Bob, we have to send a message to Santa in the form: <b>E(K,Ks)E(K[C,Pc])</b>. <br> The first thing to do is to encrypt the session key using the Public Key of Santa and then encrypt Bob credentials with the session key. Finally we can send it to Santa
          </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-text">
Ciphertext of session key: X3jNetWSFcDFDtYT8DgmjoAz8+opAt5ZnUr22ikDuymrtk8dqp38RfYQnmWSkPREk+NqU3do4mIgObKyGL46AH3J2QQXhOB2VuUO0/vkl7ESGqHCL6zCw+71mOkXi6tVCYas1JBmDSlbjcVKOX6LWdrw0F6v5B98b5gq/s7VQqo=

Ciphertext of credentials: Sm8rTVE0dk5mRzBPRFJ6dGkrNEVXZz09
          </code></pre>
        </div>

        <dl>
          <dd>
            The reply from Santa is the following:
          </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-text">
Hello! This is Santa server!
Reply: ZUd0QmRFc3pxTG5sYXdEK0xRUzE0dmNyTkgrbjZUSldDdkNqV3VmcXNLbnI2OGJOakNOSWtQTXpzMHdpa3l6Ng==

My public key is:

-----BEGIN PUBLIC KEY-----
MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDh+G+5W2m6bQu5iAhiPsSS0YvJ
IPGNZ8JRhdZXSaqLnRw7I6eHc31XeC/9s9zzrSVDPrR33F13e2uTsdt8sYPusy3h
S6Zx9DPMOsi0+ZUmV0F10QAI//Kwm8NmbzLaS/sxYrA3scrPxwL8vyHwEXgo4spx
kK95AfPn2q723BoufQIDAQAB
-----END PUBLIC KEY-----
          </code></pre>
        </div>

        <dl>
          <dd>
            We can finally decrypt the reply of Santa by using the session key and get our flag. <br> <br> A special thanks goes to one of my closest friend who helped me solving this challenge and officially started the CTF's journey. Welcome on board A.
          </dd>
        </dl>

        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong> CCIT{C0ngr4tz_y0u_l34rn_k3y_3xch4ng3!} </strong></p>
          </blockquote>
        </dl>
        </div>
        <hr>
<!-- Finish post  -->
<!-- Start Post  -->
        <dl class="anchor" id="kerberos-simulator">
          <dt> Kerberos Simulator - Points: 500 </dt>
          <dd> No ticket no flag!<br>
            <code> http://kerberos.challs.cyberchallenge.it/</code>
          </dd>
        </dl>

          <div class="fig-container">
            <figure class="zoom" onmousemove="zoom(event)"
            style="background-image: url('img/8-02-kerberos-simulator_1.png')" >
              <img src="img/8-02-kerberos-simulator_1.png" alt="" />
            </figure>
          </div>
          <br>

          <div class="fig-container">
            <figure class="zoom" onmousemove="zoom(event)"
            style="background-image: url('img/8-02-kerberos-simulator_2.png')" >
              <img src="img/8-02-kerberos-simulator_2.png" alt="" />
            </figure>
          </div>
          <br>

          <div class="row-full code">
            <pre><code class="prism language-text">
Key = 192883939

The Authentication Server says:
Encrypted Key Message: VlBYOGlmQ0Qwa0ZsNWV0bkNuUG1iamovamdoMlMxbUNoM0x0SkU3bzZlL3Z3dVg3QUZvbCtVUDFXWnJ4NTdoRG13S1hxeXY1d3NQZjJ5bklaYkNFSUE9PQ==

Authentication Ticket: SnEvMk40U0ZkQjJEenIrbVR0VUd5Ly9iYW5qdjBIZWpaV09BUU45OGN2RlNmWmVuMHZCMGtMMFBHR0NJRGhrOVBlVTZkWURpV00zYlpGbnVOVFptSlE9PQ==
            </code></pre>
          </div>

        <dl>
          <dd>
             The first thing we can do here, it's to decrypt the encrypted key message using the key.
          </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-text">
Plaintext
{K_A_TGS=747822, TGS=tgs1, Timestamp=2020:5:16:17:44:44}
          </code></pre>
        </div>

        <dl>
          <dd>
             Then we can encrypt the following message <b>{Client=Alice, Timestamp=2020:5:16:17:44:44}</b> by using the key <b>747822</b> obtained into the previous step in order to have our <i>"Authenticator"</i>
          </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-text">
Encrypted Message: dkp4N25IZVNXbmVLenVCQVU5QjlWb3lZaWlpUjQ1K1NmRVVtRHo2ejJydTh0ZldrOFMzcGlMcTZEZGpsSEZPLw==
          </code></pre>
        </div>

        <dl>
          <dd>
            We are now able to issue a request to the TGS with the following parameters
          </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-text">
Authentication Ticket: SnEvMk40U0ZkQjJEenIrbVR0VUd5Ly9iYW5qdjBIZWpaV09BUU45OGN2RlNmWmVuMHZCMGtMMFBHR0NJRGhrOVBlVTZkWURpV00zYlpGbnVOVFptSlE9PQ====

Authenticator:
TW5mRjRaelA0UERrdnRZWFdXRWY5YkNlL0F4MXVDMHdXT1h0SFE0ZDZvR0lVZWhsenY1MkRGSG9oNUl4RFpqZQ
          </code></pre>
        </div>

        <dl>
          <dd>
            Which response is:
          </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-text">
The TGS says:
Encrypted Message: dkp4N25IZVNXbmVLenVCQVU5QjlWb3lZaWlpUjQ1K1NmRVVtRHo2ejJydTh0ZldrOFMzcGlMcTZEZGpsSEZPLw==
          </code></pre>
        </div>

        <dl>
          We can now simply decrypt the message by using the key <b>747822</b> and get our flag.
        </dl>

        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong> CCIT{K3rb3r0s_4uth3nt1c4t10n_Pr0t0c0l} </strong></p>
          </blockquote>
        </dl>
        </div>
        <hr>
<!-- Finish post  -->

    	</article>
      <section class="" role="group">
        <button id="previous" onClick="location.href='software_security.html'" > Previous </button>
        <button id="next" onClick="location.href='web_security.html'"> Next </button>
        <br> <br> <br>
      </section>

      </div>
    </main>

    <!-- Footer -->
    <div id="include_footer"></div>


    <script type="text/javascript" src="/fonts/fontawesome.js"></script>
    <script type="text/javascript" src="/res/bootstrap.min.js"></script>
    <script type="text/javascript" src="/res/jquery-3.4.1.js"></script>
    <script type="text/javascript" src="/js/jquery.touchSwipe.min.js"></script>
    <script type="text/javascript" src="/js/sidebar.js"> </script>
    <script type="text/javascript" src="/js/return_to_top_arrow.js"></script>
    <script type="text/javascript" src="/res/prism_themes/prism_lb.js"></script>
    <script type="text/javascript" src="/js/img-zoom.js"></script>


    <!-- Import HTML -->
    <script>
      // import navbar
      $("#include_navbar").load("/html_import/navbar.html", function(){

        // function to activate the hamburger menu
        $('.menu-toggle').click(function(){
          $('nav').toggleClass('active');
        });
      });

      // import footer
      $(function(){
        $("#include_footer").load("/html_import/footer.html");
      });

      // import sidebar
      $(function(){
        $("#include_sidebar").load("../../html/sidebar.html");
      });
    </script>

  </body>
</html>
