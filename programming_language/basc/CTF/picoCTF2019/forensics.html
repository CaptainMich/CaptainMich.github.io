<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title> picoCTF2019 | Forensics Writeup </title>
    <link rel="shortcut icon" href="/img/favicon.ico" width="70">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Catamaran:100,200,300,400,500,600,700,800,900|Cormorant+Garamond:300,300i,400,400i,500,500i,600,600i,700,700i">
      <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css">
      <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/css/bootstrap.min.css" integrity="sha384-Smlep5jCw/wG7hdkwQ/Z5nLIefveQRIY9nfy6xoR1uRYBtpZgI6339F5dgvm/e9B" crossorigin="anonymous">
      <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
      <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.5.0/themes/prism.min.css"> -->
      <link rel="stylesheet" href="/css/style.css">
      <link rel="stylesheet" href="/css/personal_icon.css">
      <link rel="stylesheet" href="/res/prism_themes/prism-base16-ateliersulphurpool.light.css">
      <link rel="stylesheet" href="../ctf.css">
      <link rel="stylesheet" href="../../css/sidebar.css">
  </head>
  <body>

    <!-- Navbar -->
    <div id="include_navbar"></div>

    <!-- Return to Top -->
    <a href="javascript:" id="return-to-top"><i class="fas fa-chevron-up"></i></a>

    <!-- Sidebar Nav -->
    <div id="nav" class="navigation">
      <div class="navigation__inner">
        <!--   Content   -->
        <h5> picoCTF2019 </h5>
        <ul>
            <li><a href="binary.html"> Binary </a></li>
            <li><a href="cryptography.html"> Cryptography </a></li>
            <li><a href="forensics.html"> Forensics </a></li>
            <li><a href="general_skill.html"> General Skill </a></li>
            <li><a href="reverse_engineering.html"> Reverse Engineering </a></li>
            <li><a href="web_exploitation.html"> Web Exploitation </a></li>
        </ul>
        <h5> OverTheWire</h5>
        <ul>
            <li><a href="../OverTheWire/bandit.html"> Bandit </a></li>
            <li><a href="../OverTheWire/leviathan.html"> Leviathan </a></li>
            <li><a href="../OverTheWire/natas.html"> Natas </a></li>
         </ul>

        <h5> CyberChallenge </h5>
        <ul>
            <li><a href="../CyberChallenge/week01-warm_up.html"> Week 01 - Warm Up </a></li>
            <li><a href="../CyberChallenge/week02-software_security1.html"> Week 02 - Software Security 1 </a></li>
            <li><a href="../CyberChallenge/week03-cryptography1.html"> Week 03 - Cryptography 1 </a></li>
            <li><a href="../CyberChallenge/week04-web_security1.html"> Week 04 - Web Security 1 </a></li>
        </ul>

        <br>
      </div>
    </div>

    <!-- Main -->
    <main>
    <div class="swipe-area"></div>
    <br><br><br>
    <div class="container">
      <article role="article">
    		<h3> Forensics Writeup </h3>
        <br>

        <dl class="toc">
          <h4> Table of Contents </h4>
          <ol class="two-colums">
            <li> <a href="#glory-of-the-garden"> Glory of the Garden - Points: 50 </a></li>
            <li> <a href="#unzip"> unzip - Points: 50 </a></li>
            <li> <a href="#so-meta"> So Meta - Points: 150 </a></li>
            <li> <a href="#what-lies-within"> What Lies Within - Points: 150 </a></li>
            <li> <a href="#extensions"> extensions - Points: 150 </a></li>
            <li> <a href="#shark-on-wire-1"> shark on wire 1 - Points: 150 </a></li>
            <li> <a href="#whitepages"> WhitePages - Points: 250 </a></li>
            <li> <a href="#c0rrupt"> c0rrupt - Points: 250 </a></li>
            <li> <a href="#like1000"> like1000 - Points: 250 </a></li>
            <li> <a href="#m00nwalk">  m00nwalk - Points: 250 </a></li>
          </ol>
        </dl>
        <hr style="margin-bottom: 3em; width: 30%; margin-left: 35%;">

        <dl class="anchor" id="glory-of-the-garden">
          <dt> Glory of the Garden - Points: 50 </dt>
          <dd> This garden contains more than it seems. You can also find the file in /problems/glory-of-the-garden_6_0d6d3ea97757b84c7a51a38daa7dca8d on the shell server. </dd>
        </dl>

        <dl>
          <blockquote>
            <p><strong>Hint:</strong> What is a hex editor? </p>
          </blockquote>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-bash">
$ wget https://2019shell1.picoctf.com/static/064eaf1591900ad250736459aa2448a0/garden.jpg
$ cat garden.jpg
          </code></pre>
        </div>

        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong>picoCTF{more_than_m33ts_the_3y3f20F5be9}</strong></p>
          </blockquote>
        </dl>
        </div>
        <hr> <!-- Finish post  -->

        <dl class="anchor" id="unzip">
          <dt> unzip - Points: 50 </dt>
          <dd> Can you unzip this file and get the flag? </dd>

          <blockquote>
            <p><strong>Hint:</strong> put the flag in the format picoCTF{XXXXX} </p>
          </blockquote>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-bash">
$ wget https://2019shell1.picoctf.com/static/37762a7e5774d7d6c1bc79e8e1758ef9/flag.zip
$ unzip file.zip
$ eog file.png
          </code></pre>
        </div>

        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong>picoCTF{unz1pp1ng_1s_3a5y} </strong></p>
          </blockquote>
        </dl>
        </div>
        <hr> <!-- Finish post  -->

        <dl class="anchor" id="so-meta">
          <dt> So Meta - Points: 150 </dt>
          <dd> Find the flag in this picture. You can also find the file in /problems/so-meta_5_7c198bd3e228862d97a40316b8a103e4. </dd>
        </dl>
        <dl>
          <blockquote>
            <p><strong>Hint:</strong>  What does meta mean in the context of files? Ever hear of metadata? </p>
          </blockquote>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-bash">
$ wget https://2019shell1.picoctf.com/static/973cd0e3beea255e6a0b5316aa6287ce/pico_img.png
$ strings image.png
          </code></pre>
        </div>

        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong>picoCTF{s0_m3ta_ffd09c0f}</strong></p>
          </blockquote>
        </dl>
        </div>
        <hr> <!-- Finish post  -->

        <dl class="anchor" id="what-lies-within">
          <dt> What Lies Within - Points: 150 </dt>
          <dd> Theres something in the building (image file). Can you retrieve the flag? </dd>
        </dl>
        <dl>
            <blockquote>
            <p><strong>Hint:</strong> There is data encoded somewhere, there might be an online decoder </p>
          </blockquote>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-bash">
$ wget https://2019shell1.picoctf.com/static/aec3861fc4d5bce4d39dc0db196426de/buildings.png

# after installing rubygems package
$ gem install zsteg
# add the executable to envinronment PATH
$ PATH="`ruby -e 'puts Gem.user_dir'`/bin:$PATH"

$ zsteg building.png
          </code></pre>
        </div>

        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong>picoCTF{h1d1ng_1n_th3_b1t5}</strong></p>
          </blockquote>
        </dl>
        </div>
        <hr> <!-- Finish post  -->

        <dl class="anchor" id="extensions">
          <dt> extensions - Points: 150 </dt>
          <dd> This is a really weird text file TXT? Can you find the flag? </dd>
        </dl>
        <dl>
          <blockquote>
            <p><strong>Hint:</strong> How do operating systems know what kind of file it is? (It's not just the ending!) </p>
          </blockquote>
          <blockquote>
            <p><strong>Hint:</strong> Make sure to submit the flag as picoCTF{XXXXX} </p>
          </blockquote>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-bash">
$ wget https://2019shell1.picoctf.com/static/45886ed4b6d5d1dc74c4944fcf4b4041/flag.txt
$ mv flag.txt flag.png
$ eog flag.png
          </code></pre>
        </div>

        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong>picoCTF{now_you_know_about_extensions}</strong></p>
          </blockquote>
        </dl>
        </div>
        <hr> <!-- Finish post  -->


        <dl class="anchor" id="shark-on-wire-1">
          <dt> shark on wire 1 - Points: 150 </dt>
          <dd> We found this packet capture. Recover the flag. You can also find the file in /problems/shark-on-wire-1_0_13d709ec13952807e477ba1b5404e620. </dd>
        </dl>
        <dl>
          <blockquote>
            <p><strong>Hint:</strong> Try using a tool like Wireshark </p>
          </blockquote>
          <blockquote>
            <p><strong>Hint:</strong> What are streams? </p>
          </blockquote>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-bash">
$ wget https://2019shell1.picoctf.com/static/ae9ca8cff43ed638ed5d137f9ece7455/capture.pcap
$ wireshark capture.pcap
# right click and then follow udp stream
          </code></pre>
        </div>

        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong>picoCTF{StaT31355_636f6e6e}</strong></p>
          </blockquote>
        </dl>
        </div>
        <hr> <!-- Finish post  -->


        <dl class="anchor" id="whitepages">
          <dt> WhitePages - Points: 250 </dt>
          <dd> I stopped using YellowPages and moved onto WhitePages... but the page they gave me is all blank! </dd>
        </dl>
        <dl>
          <blockquote>
            <p><strong>Hint:</strong> </p>
          </blockquote>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-bash">
$ wget https://2019shell1.picoctf.com/static/d7068f4c75d7b4a3e342cc57d528c5ce/whitepages.txt
$ xxd whitepages.txt
          </code></pre>
        </div>

        <div class="row-full code">
          <pre><code class="prism language-python">
from pwn import *

with open('./whitepages.txt', 'rb') as f:
  data = f.read()

data  = data.replace('e28083'.decode('hex'), '0').replace('20'.decode('hex'), '1')

print unbits(data)
          </code></pre>
        </div>


        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong>picoCTF{not_all_spaces_are_created_equal_178d720252af1af29369e154eca23a95}</strong></p>
          </blockquote>
        </dl>
        </div>
        <hr> <!-- Finish post  -->

        <dl class="anchor" id="c0rrupt">
          <dt> c0rrupt - Points: 250 </dt>
          <dd> We found this file. Recover the flag. You can also find the file in /problems/c0rrupt_0_1fcad1344c25a122a00721e4af86de13. </dd>
        </dl>
        <dl>
          <blockquote>
            <p><strong>Hint:</strong> Try fixing the file header </p>
          </blockquote>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-bash">
$ wget https://2019shell1.picoctf.com/static/3435d990f1d20fe3563cbb897b4c96db/mystery
$ ghex mystery
          </code></pre>
        </div>

        <dl>
          <dd> The header is similar as PNG header -> 89 50 4E 47 0D 0A 1A 0A. Substitute the value in. </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-bash">
$ pngcheck mystery
          </code></pre>
        </div>

        <dl>
          <dd> OUTPUT -> mystery: invalid chunk name "C"DR" (43 22 44 52) </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-bash">
$ ghex mystery
          </code></pre>
        </div>

        <dl>
          <dd> Look for that bytes in the hex editor, they are in the IHDR Image Header which specify that chunk type must contains the value 49 48 44 52 (IHDR, that is the equivalent respectively of 73 72 68 82) </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-bash">
$ pngcheck mystery
          </code></pre>
        </div>

        <dl>
          <dd> OUTPUT -> mystery CRC error in chunk pHYs (computed 38d82c82, expected 495224f0) </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-bash">
$ ghex mystery
          </code></pre>
        </div>

        <dl>
          <dd> Look for the expected bytes in the hex editor and substitute them with the computed one </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-bash">
$ pngcheck mystery
          </code></pre>
        </div>

        <dl>
          <dd> OUTPUT -> mystery invalid chunk length (too large) </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-bash">
$ ghex mystery
          </code></pre>
        </div>

        <dl>
          <dd> The bytes AB 44 45 54 must contains the IDAT chunk, substitute with 49 44 41 54. The other problem is the chunk’s length: AA AA FF A5, is too big. Since it's not possible to identify CRCs in order to find the end of the chunk, we must look for the next IDAT chunk because IDAT chunk must be consecutive. The next IDAT chunk is at offset 10008 while the first IDAT it's at offset 00057. Do the math, the difference is FFB1. We must subtract 4 bytes for the length field of the second IDAT, subtract 4 bytes for the CRC of the first IDAT, and subtract 4 bytes again for the chunktype of the first IDAT, 12 bytes in total. The math give us FF A5. We can replace now the value AA AA FF A5 with 00 00 FF A5.
          </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-bash">
$ pngcheck mystery
          </code></pre>
        </div>

        <dl>
          <dd> OUTPUT -> OK: mystery (1642x1095, 24-bit RGB, non-interlaced, 96.3%) </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-bash">
$ eog mystery
          </code></pre>
        </div>



        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong> picoCTF{c0rrupt10n_1847995} </strong></p>
          </blockquote>
        </dl>
        </div>
        <hr> <!-- Finish post  -->

        <dl class="anchor" id="like1000">
          <dt> like1000 - Points: 250 </dt>
          <dd> This .tar file got tarred alot. Also available at /problems/like1000_0_369bbdba2af17750ddf10cc415672f1c.</dd>
        </dl>
        <dl>
          <blockquote>
            <p><strong>Hint:</strong> Try and script this, it'll save you alot of time </p>
          </blockquote>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-bash">
$ wget https://2019shell1.picoctf.com/static/8694f84879d3b7c0dcf775930f4665fc/1000.tar
          </code></pre>
        </div>

        <div class="row-full code">
          <pre><code class="prism language-bash">
#!/bin/bash

for i in $(seq 1000 -1 1)
do
  tar xvf "$i.tar"
done
          </code></pre>
        </div>

        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong> picoCTF{l0t5_0f_TAR5} </strong></p>
          </blockquote>
        </dl>
        </div>
        <hr> <!-- Finish post  -->

        <dl class="anchor" id="m00nwalk">
          <dt> m00nwalk - Points: 250 </dt>
          <dd> Decode this message from the moon. You can also find the file in /problems/m00nwalk_0_05441e9344c829ba5a648e8b28ef1564.</dd>
        </dl>
        <dl>
          <blockquote>
            <p><strong>Hint:</strong> How did pictures from the moon landing get sent back to Earth? </p>
          </blockquote>

          <blockquote>
            <p><strong>Hint:</strong> What is the CMU mascot?, that might help select a RX option </p>
          </blockquote>

        </dl>

        <div class="row-full code">
          <pre><code class="prism language-bash">
$ wget https://2019shell1.picoctf.com/static/fe892e7bef69b386ce5638053c0d312c/message.wav
# http://users.belgacom.net/hamradio/rxsstv.htm

          </code></pre>
        </div>

        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong> picoCTF{beep_boop_im_in_space} </strong></p>
          </blockquote>
        </dl>
        </div>
        <hr> <!-- Finish post  -->



    	</article>

      <section class="" role="group">
        <button id="previous" onClick="location.href='cryptography.html'" > Previous </button>
        <button id="next" onClick="location.href='general_skill.html'"> Next </button>
        <br> <br> <br>
      </section>


      </div>
    </main>

    <!-- Footer -->
    <div id="include_footer"></div>



    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/js/bootstrap.min.js" integrity="sha384-o+RDsa0aLu++PJvFqy8fFScvbHFLtbvScb8AjopnFD+iEQ7wo/CG0xlczd+2O/em" crossorigin="anonymous"></script>
    <script type="text/javascript" src="https://unpkg.com/ionicons@4.1.2/dist/ionicons.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.5.0/prism.min.js"></script>
    <script type="text/javascript" src="/res/jquery-3.4.1.js"></script>
    <script type="text/javascript" src="/js/jquery.touchSwipe.min.js"></script>
    <script type="text/javascript"src="/js/sidebar.js"> </script>
    <script type="text/javascript" src="/js/return_to_top_arrow.js"></script>
    <script type="text/javascript" src="/res/prism_themes/prism_lb.js"></script>

    <!-- Import HTML -->
    <script>
      // import navbar
      $("#include_navbar").load("/html_import/navbar.html", function(){

        // function to activate the hamburger menu
        $('.menu-toggle').click(function(){
          $('nav').toggleClass('active');
        });
      });

      // import footer
      $(function(){
        $("#include_footer").load("/html_import/footer.html");
      });
   </script>

  </body>
</html>
