<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title> CyberChallenge | Web Security </title>
    <link rel="shortcut icon" href="/img/favicon.ico" width="70">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <link rel="stylesheet" href="/fonts/fonts.css" >
      <link rel="stylesheet" href="/res/bootstrap.min.css">
      <link rel="stylesheet" href="/res/w3.css">
      <link rel="stylesheet" href="/css/style.css">
      <link rel="stylesheet" href="/css/personal_icon.css">
      <link rel="stylesheet" href="/res/prism_themes/prism-base16-ateliersulphurpool.light.css">
      <link rel="stylesheet" href="../ctf.css">
      <link rel="stylesheet" href="../../css/sidebar.css">
  </head>
  <body>

    <!-- Navbar -->
    <div id="include_navbar"></div>

    <!-- Return to Top -->
    <a href="javascript:" id="return-to-top"><i class="fas fa-chevron-up"></i></a>

    <!-- Sidebar Nav -->
    <div id="include_sidebar"></div>

    <!-- Main -->
    <main>
    <div class="swipe-area"></div>
    <br><br><br>
    <div class="container">
      <article role="article">
    		<h3> Web Security </h3>
        <br>

        <dl class="toc">
          <h4> Table of Contents </h4>
          <ol class="two-colums">
            <h5> Week 1 </h5>
            <li> <a href="#basic-rce"> BasicRCE - Points: 500 </a></li>
            <li> <a href="#php-is-love-php-is-life"> PHPisLovePHPisLife - Points: 500 </a></li>
            <li> <a href="#zip-zap-level-1"> ZipZap - level 1 - Points: 500 </a></li>
            <li> <a href="#plotty-boy"> Plotty boy - Points: 500 </a></li>
            <li> <a href="#ssrf-basic-level-1"> SSRF Basic - level 1 - Points: 500 </a></li>
            <li> <a href="#ssrf-basic-level-2"> SSRF Basic - level 2 - Points: 500 </a></li>
            <li> <a href="#302camo"> 302Camo - Points: 500 </a></li>
            <li> <a href="#basic-lfi"> Basic LFI - Points: 500 </a></li>
            <li> <a href="#not-a-bug"> Not a Bug. It's a Feature - Points: 500 </a></li>
          </ol>
          <hr style="margin-bottom: 0em; width: 20%; margin-left: 42%;">
          <ol>
            <h5> Week 2 </h5>
            <li> <a href="#sql-injection-tutorial-1"> SQL Injection Tutorial 1 - Points: 500 </a></li>
            <li> <a href="#sql-injection-tutorial-2"> SQL Injection Tutorial 2 - Points: 500 </a></li>
            <li> <a href="#sql-injection-tutorial-3"> SQL Injection Tutorial 3 - Points: 500 </a></li>
            <li> <a href="#sql-injection-tutorial-4"> SQL Injection Tutorial 4 - Points: 500 </a></li>
          </ol>
        </dl>
        <hr style="margin-bottom: 3em; width: 30%; margin-left: 35%;">

<!-- Start Post  -->
        <dl class="anchor" id="basic-rce">
          <dt> BasicRCE - Points: 500 </dt>
          <dd> How do injections work? <br>
          <a href="http://149.202.200.158:5001/" style="color: #e94892;"> http://149.202.200.158:5001/ </a>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-bash">

          </code></pre>
        </div>

        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong>  </strong></p>
          </blockquote>
        </dl>
        </div>
        <hr>
<!-- Finish post  -->
<!-- Start Post  -->
        <dl class="anchor" id="php-is-love-php-is-life">
          <dt> PHPisLovePHPisLife - Points: 500 </dt>
          <dd> We all love PHP code injections &lt;3 <br>
          <a href="http://149.202.200.158:5007/" style="color: #e94892;"> http://149.202.200.158:5007/ </a>
        </dl>


        <div class="fig-container">
          <figure class="zoom" onmousemove="zoom(event)"
          style="background-image: url('\img/4-02-phpislove_phpislife.png')" >
            <img src="img/4-02-phpislove_phpislife.png" alt="" />
          </figure>
        </div>

        <div class="row-full code">
          <pre><code class="prism language-html">
&lt;?php
if(isset($_GET['source'])){
    highlight_file(__FILE__);
    return;
}
error_reporting(0);
$flag = getenv('FLAG');
?>
    &lt;html>

    &lt;head>
        &lt;meta charset="utf-8">
        &lt;title>PHPisLovePHPisLife&lt;/title>
        &lt;meta name="viewport" content="width=device-width, initial-scale=1">
        &lt;link rel="stylesheet" type="text/css" media="screen" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.4/css/bulma.min.css">
    &lt;/head>

    &lt;body>
        &lt;section class="hero">
            &lt;div class="hero-body">
                &lt;div class="container">
                    &lt;h1 class="title">
        PHPisLovePHPisLife
      &lt;/h1>
                    &lt;h2 class="subtitle">
         You can view the source code &lt;a href="/?source">here&lt;/a>
      &lt;/h2>
                &lt;/div>
            &lt;/div>
        &lt;/section>
        &lt;section class="section">
            &lt;div class="columns">
                &lt;div class="column">&lt;/div>
                &lt;div class="column">
                    &lt;div class="container">

                        &lt;form method="POST">
                            &lt;div class="field">
                                &lt;div class="control">
                                    &lt;input class="input" type="text" placeholder="Put some code" name="code">
                                &lt;/div>
                            &lt;/div>
                            &lt;div class="field">
                                &lt;div class="control">
                                    &lt;input class="submit" type="submit" placeholder="Send" value="Send">
                                &lt;/div>
                            &lt;/div>
                        &lt;/form>
                    &lt;/div>

                    &lt;div class="box">
                        &lt;pre class="has-background-white">
&lt;?php
if(isset($_POST['code'])){

    $code = $_POST['code'];
    // I &lt;3 blacklists
    $characters = ['\`', '\[', '\*', '\.', '\\\\', '\='];
    $classes = get_declared_classes();
    $functions = get_defined_functions()['internal'];
    $strings = ['eval', 'include', 'require', 'function', 'flag', 'echo'];
    $variables =  ['_GET', '_POST', '_COOKIE', '_REQUEST', '_SERVER', '_FILES', '_ENV', 'HTTP_ENV_VARS', '_SESSION', 'GLOBALS'];

    $blacklist = array_merge($characters, $classes, $functions, $variables,$strings);

    foreach ($blacklist as $blacklisted) {

        if (preg_match ('/' . $blacklisted . '/im', $code)) {

            $output = 'No hacks pls';
        }
    }

    if(!isset($output)){
        $my_function = create_function('',$code);
        // $output = $my_function(); // I don't trust you
        $output = 'This function is disabled.';
    }
    echo $output;
}
                ?>
            &lt;/pre>
                    &lt;/div>

                &lt;/div>
                &lt;div class="column">&lt;/div>
            &lt;/div>
        &lt;/section>
    &lt;/body>

    &lt;/html>
          </code></pre>
        </div>

        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong>  </strong></p>
          </blockquote>
        </dl>
        </div>
        <hr>
<!-- Finish post  -->
<!-- Start Post  -->
        <dl class="anchor" id="zip-zap-level-1">
          <dt> ZipZap - level 1 - Points: 500 </dt>
          <dd> This service has two flags in two levels. The first one is on the file /flag.txt <br>
          <a href="http://149.202.200.158:5011/" style="color: #e94892;"> http://149.202.200.158:5011/ </a>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-bash">
          </code></pre>
        </div>

        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong>  </strong></p>
          </blockquote>
        </dl>
        </div>
        <hr>
<!-- Finish post  -->
<!-- Start Post  -->
        <dl class="anchor" id="plotty-boy">
          <dt> Plotty boy - Points: 500 </dt>
          <dd> Because I’m a CyberChallenge web guy, I cannot do any math. For this reason, I created this useful web site that plots math things for me. Can you please look for any vulns? <br> <br>
          The flag is located on /flag.txt <br>
          <a href="http://149.202.200.158:5009/" style="color: #e94892;"> http://149.202.200.158:5009/ </a>
        </dl>


        <dl>
          <blockquote>
            <p><strong> You don’t need to bruteforce anything; there are no hidden files/secrets. Just look at what you have:) </strong> <br>
            </p>
          </blockquote>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-bash">
          </code></pre>
        </div>

        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong>  </strong></p>
          </blockquote>
        </dl>
        </div>
        <hr>
<!-- Finish post  -->
<!-- Start Post  -->
        <dl class="anchor" id="ssrf-basic-level-1">
          <dt> SSRF Basic - level 1 - Points: 500 </dt>
          <dd> An entry level challenge. There are 4 different levels with 4 different flags. Go Go Go! <br>
          <a href="http://149.202.200.158:5002/" style="color: #e94892;"> http://149.202.200.158:5002/ </a>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-bash">
          </code></pre>
        </div>

        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong>  </strong></p>
          </blockquote>
        </dl>
        </div>
        <hr>
<!-- Finish post  -->
<!-- Start Post  -->
        <dl class="anchor" id="ssrf-basic-level-2">
          <dt> SSRF Basic - level 2 - Points: 500 </dt>
          <dd> An entry level challenge. There are 4 different levels with 4 different flags. Go Go Go! <br>
          <a href="http://149.202.200.158:5003/" style="color: #e94892;"> http://149.202.200.158:5003/ </a>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-bash">
          </code></pre>
        </div>

        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong>  </strong></p>
          </blockquote>
        </dl>
        </div>
        <hr>
<!-- Finish post  -->
<!-- Start Post  -->
        <dl class="anchor" id="302camo">
          <dt> 302Camo - Points: 500 </dt>
          <dd> A simple PHP blog. We know for sure that there is a flag at the link <a href="http://149.202.200.158:5010/get_flag.php" style="color: #e94892;"> http://149.202.200.158:5010/get_flag.php </a> , but it doesn't seem reachable from the internet. Good luck!
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-bash">
          </code></pre>
        </div>

        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong>  </strong></p>
          </blockquote>
        </dl>
        </div>
        <hr>
<!-- Finish post  -->
<!-- Start Post  -->
        <dl class="anchor" id="basic-lfi">
          <dt> Basic LFI - Points: 500 </dt>
          <dd> I found this nice html template to write fancy web sites. I decided to start writing a simple PHP blog out of it, and, as every respectful project, I started a little bug bounty program. Are you able to find the content of the file flag.txt located in the root directory? A free flag as payment :) <br>

          <a href="http://149.202.200.158:5000/" style="color: #e94892;"> http://149.202.200.158:5000/ </a>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-bash">
          </code></pre>
        </div>

        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong>  </strong></p>
          </blockquote>
        </dl>
        </div>
        <hr>
<!-- Finish post  -->
<!-- Start Post  -->
        <dl class="anchor" id="not-a-bug">
          <dt> Not a Bug. It's a Feature - Points: 500 </dt>
          <dd> Sometimes ago, I found a bug in one of the products of this company. They said it was not a bug, but I'm not sure about it. This is their main site, can you find another "non-bug"? <br>
          <a href="http://149.202.200.158:5006/" style="color: #e94892;"> http://149.202.200.158:5006/ </a>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-bash">
          </code></pre>
        </div>

        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong>  </strong></p>
          </blockquote>
        </dl>
        </div>
        <hr>
<!-- Finish post  -->
<!-- Start Post  -->
        <dl class="anchor" id="sql-injection-tutorial-1">
          <dt> SQL Injection Tutorial 1 - Points: 500 </dt>
          <dd> <a href="http://sqlinjection.challs.cyberchallenge.it/logic" style="color: #e94892;"> http://sqlinjection.challs.cyberchallenge.it/logic </a></dd>
        </dl>

        <dl>
          As we can see from the image below this is a <b>Logical Injections</b> SQL type challenge
        </dl>

        <div class="fig-container">
          <figure class="zoom" onmousemove="zoom(event)"
          style="background-image: url('img/9-01-sql_injection_tut_1_1.png')" >
            <img src="img/9-01-sql_injection_tut_1_1.png" alt="" />
          </figure>
        </div>
        <br>

        <div class="fig-container">
          <figure class="zoom" onmousemove="zoom(event)"
          style="background-image: url('img/9-01-sql_injection_tut_1_2.png')" >
            <img src="img/9-01-sql_injection_tut_1_2.png" alt="" />
          </figure>
        </div>
        <br>

        <div class="fig-container">
          <figure class="zoom" onmousemove="zoom(event)"
          style="background-image: url('img/9-01-sql_injection_tut_1_3.png')" >
            <img src="img/9-01-sql_injection_tut_1_3.png" alt="" />
          </figure>
        </div>
        <br>

        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong> CCIT{1s_ths_h0w_l0g1ns_w0rk} </strong></p>
          </blockquote>
        </dl>
        </div>
        <hr>
<!-- Finish post  -->
<!-- Start Post  -->
        <dl class="anchor" id="sql-injection-tutorial-2">
          <dt> SQL Injection Tutorial 2 - Points: 500 </dt>
          <dd> <a href="http://sqlinjection.challs.cyberchallenge.it/union" style="color: #e94892;"> http://sqlinjection.challs.cyberchallenge.it/union </a></dd>
        </dl>

        <dl>
          As we can see from image below this is <b> Union Based </b> SQL type challenge
        </dl>

        <div class="fig-container">
          <figure class="zoom" onmousemove="zoom(event)"
          style="background-image: url('img/9-02-sql_injection_tut_2_1.png')" >
            <img src="img/9-02-sql_injection_tut_2_1.png" alt="" />
          </figure>
        </div>
        <br>

        <div class="fig-container">
          <figure class="zoom" onmousemove="zoom(event)"
          style="background-image: url('img/9-02-sql_injection_tut_2_2.png')" >
            <img src="img/9-02-sql_injection_tut_2_2.png" alt="" />
          </figure>
        </div>
        <br>

        <div class="fig-container">
          <figure class="zoom" onmousemove="zoom(event)"
          style="background-image: url('img/9-02-sql_injection_tut_2_3.png')" >
            <img src="img/9-02-sql_injection_tut_2_3.png" alt="" />
          </figure>
        </div>
        <br>

        <div class="fig-container">
          <figure class="zoom" onmousemove="zoom(event)"
          style="background-image: url('img/9-02-sql_injection_tut_2_4.png')" >
            <img src="img/9-02-sql_injection_tut_2_4.png" alt="" />
          </figure>
        </div>
        <br>

        <div class="fig-container">
          <figure class="zoom" onmousemove="zoom(event)"
          style="background-image: url('img/9-02-sql_injection_tut_2_5.png')" >
            <img src="img/9-02-sql_injection_tut_2_5.png" alt="" />
          </figure>
        </div>
        <br>

        <dl>
          Using the following query, you can retrieve all the tables that are accessible by the current user
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-sql">
SELECT table_name FROM information_schema.tables
          </code></pre>
        </div>

        <dl>
          Because there are a lot of ""system"" tables, that don't contain any useful information, you may want to exclude them by querying only for tables that are in the current schema. In order to retrieve the current schema, you can use the function <code>DATABASE()</code>. So the above query becomes:
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-sql">
SELECT table_name FROM information_schema.tables WHERE table_schema = DATABASE()
          </code></pre>
        </div>
        <br>

        <div class="fig-container">
          <figure class="zoom" onmousemove="zoom(event)"
          style="background-image: url('img/9-02-sql_injection_tut_2_6.png')" >
            <img src="img/9-02-sql_injection_tut_2_6.png" alt="" />
          </figure>
        </div>

        <dl>
          And for retrieving a list of all columns of a particular table:
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-sql">
SELECT column_name FROM information_schema.columns WHERE table_name = '*name_of_the_table*'
          </code></pre>
        </div>
        <br>

        <div class="fig-container">
          <figure class="zoom" onmousemove="zoom(event)"
          style="background-image: url('img/9-02-sql_injection_tut_2_7.png')" >
            <img src="img/9-02-sql_injection_tut_2_7.png" alt="" />
          </figure>
        </div>

        <dl>
          You can also retrieve all columns-tables with the following query:
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-sql">
SELECT table_name,column_name from information_schema.columns WHERE table_schema=DATABASE()
          </code></pre>
        </div>
        <br>

        <div class="fig-container">
          <figure class="zoom" onmousemove="zoom(event)"
          style="background-image: url('img/9-02-sql_injection_tut_2_8.png')" >
            <img src="img/9-02-sql_injection_tut_2_8.png" alt="" />
          </figure>
        </div>

        <dl>
          Now you have anything that you need to retrive the flag; You only need to adapt the queries. The only problem you can encounter is the closing <code>'</code>, that will break your sintax. You have two options: <br>
           - You comment it out, using the MySQL comment syntax -- (note that it needs a space character at the end) <br>
           -  You can add an <code>AND</code> clause to the where that is always true, for example:
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-sql">
UNION SELECT first_column,second_column,3,4,5,6 FROM table WHERE somecolumn='something' --
UNION SELECT first_column,second_column,3,4,5,6 FROM table WHERE somecolumn='something' and 1='1
          </code></pre>
        </div>
        <br>

        <dl>
          In this way, the append quote will close the <code>1='1</code>, and the query will be syntactically correct. <br> <br>

          Let's try to retrieve our flag
        </dl>

        <div class="fig-container">
          <figure class="zoom" onmousemove="zoom(event)"
          style="background-image: url('img/9-02-sql_injection_tut_2_9.png')" >
            <img src="img/9-02-sql_injection_tut_2_9.png" alt="" />
          </figure>
        </div>
        <br>

        <div class="fig-container">
          <figure class="zoom" onmousemove="zoom(event)"
          style="background-image: url('img/9-02-sql_injection_tut_2_10.png')" >
            <img src="img/9-02-sql_injection_tut_2_10.png" alt="" />
          </figure>
        </div>

        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong> CCIT{Uni0ns_4re_so_tr1vi4l} </strong></p>
          </blockquote>
        </dl>
        </div>
        <hr>
<!-- Finish post  -->
<!-- Start Post  -->
        <dl class="anchor" id="sql-injection-tutorial-3">
          <dt> SQL Injection Tutorial 3 - Points: 500 </dt>
          <dd> <a href="http://sqlinjection.challs.cyberchallenge.it/blind
" style="color: #e94892;"> http://sqlinjection.challs.cyberchallenge.it/blind</a></dd>
        </dl>

        <dl>
          As we can see from the image below this is a <b>Blind</b> SQL type challenge
        </dl>

        <div class="fig-container">
          <figure class="zoom" onmousemove="zoom(event)"
          style="background-image: url('img/9-03-sql_injection_tut_3_1.png')" >
            <img src="img/9-03-sql_injection_tut_3_1.png" alt="" />
          </figure>
        </div>
        <br>

        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong> CCIT{} </strong></p>
          </blockquote>
        </dl>
        </div>
        <hr>
<!-- Finish post  -->

    	</article>

      <section class="" role="group">
        <button id="previous" onClick="location.href='cryptography.html'" > Previous </button>
        <button id="next" onClick="location.href='network_security.html"> Next </button>
        <br> <br> <br>
      </section>

      </div>
    </main>

    <!-- Footer -->
    <div id="include_footer"></div>



    <script type="text/javascript" src="/fonts/fontawesome.js"></script>
    <script type="text/javascript" src="/res/bootstrap.min.js"></script>
    <script type="text/javascript" src="/res/jquery-3.4.1.js"></script>
    <script type="text/javascript" src="/js/jquery.touchSwipe.min.js"></script>
    <script type="text/javascript" src="/js/sidebar.js"> </script>
    <script type="text/javascript" src="/js/return_to_top_arrow.js"></script>
    <script type="text/javascript" src="/res/prism_themes/prism_lb.js"></script>
    <script type="text/javascript" src="/js/img-zoom.js"></script>

    <!-- Import HTML -->
    <script>
      // import navbar
      $("#include_navbar").load("/html_import/navbar.html", function(){

        // function to activate the hamburger menu
        $('.menu-toggle').click(function(){
          $('nav').toggleClass('active');
        });
      });

      // import footer
      $(function(){
        $("#include_footer").load("/html_import/footer.html");
      });

      // import sidebar
      $(function(){
        $("#include_sidebar").load("../../html/sidebar.html");
      });
    </script>

  </body>
</html>
